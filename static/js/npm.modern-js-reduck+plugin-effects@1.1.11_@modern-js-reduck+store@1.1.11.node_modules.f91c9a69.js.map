{"version":3,"file":"static/js/npm.modern-js-reduck+plugin-effects@1.1.11_@modern-js-reduck+store@1.1.11.node_modules.f91c9a69.js","mappings":"uIAGA,Q,SAAqB,C,kFCCrB,MAGMA,EAAaC,GACH,OAAVA,GAAmC,iBAAVA,IACpBA,GAA+B,mBAAfA,EAAMC,MAI3BC,EAAmC,CAACC,EAAOC,EAAMC,EAASC,KAC9D,MAAMC,EAAO,CACXH,GAEII,EAAYC,IAChB,GAAwB,mBAAbA,EAAyB,CAClC,MAAMC,EAAOH,EAAKI,KAAK,KAAKC,cAC5BN,EAAkBC,EAAKM,SAAS,IAAIC,KAClC,MAAMd,EAAQS,KAAYK,GAK1B,GAAIf,EAAUC,IAA2B,mBAAVA,EAAsB,CACnD,MAAMe,GALUC,EAKKhB,EALOG,EAAMc,SAAS,CAC3CP,OACAM,aAIA,OAAIjB,EAAUgB,GACLA,EAAId,MAAMiB,GAzBG,CAACA,GACR,iBAATA,GAAqBA,EAAKC,eAAe,WAAaD,EAAKC,eAAe,SAwBpDC,CAAwBF,GAAQA,EAAKlB,MAAQkB,IAElEH,CACT,CAViB,IAACC,EAWlB,OAAOhB,CAAK,GAEhB,MACEqB,OAAOC,KAAKb,GAAUc,SAASC,IAC7BjB,EAAKkB,KAAKD,GACVhB,EAASC,EAASe,IAClBjB,EAAKmB,KAAK,GAEd,EAEFlB,EAASH,EAAQ,EA6BnB,GA3Be,QAAcsB,IAAY,CACvCC,OAAOC,IACE,IAAAC,IAAqB,IAAAA,GAAe,CAAC,EAAGD,GAAc,CAC3DE,YAAa,EACX,QAAc,CACZC,qBAAsB,SAGrBH,EAAYE,aAAe,MAIpC,UAAAE,EAAW,UAAEC,EAAS,aAAEC,IAAgB,kBAAE7B,IACxC,MAAM,QAAED,GAAY6B,EACpB,OAAK7B,GAMLH,EAAiCyB,EAAQxB,MAAO+B,EAAU9B,KAAM8B,EAAU7B,QAASC,GAC5E,CACL4B,YACAC,iBARO,CACLD,YACAC,eAQN,K","sources":["webpack://@sinsa/web/../../node_modules/.pnpm/@modern-js-reduck+plugin-effects@1.1.11_@modern-js-reduck+store@1.1.11/node_modules/@modern-js-reduck/plugin-effects/dist/esm/index.js","webpack://@sinsa/web/../../node_modules/.pnpm/@modern-js-reduck+plugin-effects@1.1.11_@modern-js-reduck+store@1.1.11/node_modules/@modern-js-reduck/plugin-effects/dist/esm/plugin.js"],"sourcesContent":["import plugin from \"./plugin\";\nimport handleEffect from \"./utils/handleEffect\";\nexport { plugin, handleEffect };\nexport default plugin;\n","import { _ as _object_spread } from \"@swc/helpers/_/_object_spread\";\nimport { _ as _object_spread_props } from \"@swc/helpers/_/_object_spread_props\";\nimport { createPlugin } from \"@modern-js-reduck/store\";\nimport { createPromise } from \"redux-promise-middleware\";\nconst isReduxPromiseFulfilled = (data) => {\n  return typeof data === \"object\" && data.hasOwnProperty(\"action\") && data.hasOwnProperty(\"value\");\n};\nconst isPromise = (value) => {\n  if (value !== null && typeof value === \"object\") {\n    return value && typeof value.then === \"function\";\n  }\n  return false;\n};\nconst createDispatchActionsFromEffects = (store, name, effects, setDispatchAction) => {\n  const path = [\n    name\n  ];\n  const traverse = (_effects) => {\n    if (typeof _effects === \"function\") {\n      const type = path.join(\"/\").toUpperCase();\n      setDispatchAction(path.slice(), (...args) => {\n        const value = _effects(...args);\n        const dispatch = (payload) => store.dispatch({\n          type,\n          payload\n        });\n        if (isPromise(value) || typeof value === \"function\") {\n          const res = dispatch(value);\n          if (isPromise(res)) {\n            return res.then((data) => isReduxPromiseFulfilled(data) ? data.value : data);\n          }\n          return res;\n        }\n        return value;\n      });\n    } else {\n      Object.keys(_effects).forEach((key) => {\n        path.push(key);\n        traverse(_effects[key]);\n        path.pop();\n      });\n    }\n  };\n  traverse(effects);\n};\nconst plugin = createPlugin((context) => ({\n  config(storeConfig) {\n    return _object_spread_props(_object_spread({}, storeConfig), {\n      middlewares: [\n        createPromise({\n          promiseTypeDelimiter: \"/\"\n        }),\n        // middlewares from config are at the end\n        ...storeConfig.middlewares || []\n      ]\n    });\n  },\n  modelMount({ modelDesc, mountedModel }, { setDispatchAction }) {\n    const { effects } = modelDesc;\n    if (!effects) {\n      return {\n        modelDesc,\n        mountedModel\n      };\n    }\n    createDispatchActionsFromEffects(context.store, modelDesc.name, modelDesc.effects, setDispatchAction);\n    return {\n      modelDesc,\n      mountedModel\n    };\n  }\n}));\nexport default plugin;\n"],"names":["isPromise","value","then","createDispatchActionsFromEffects","store","name","effects","setDispatchAction","path","traverse","_effects","type","join","toUpperCase","slice","args","res","payload","dispatch","data","hasOwnProperty","isReduxPromiseFulfilled","Object","keys","forEach","key","push","pop","context","config","storeConfig","_","middlewares","promiseTypeDelimiter","modelMount","modelDesc","mountedModel"],"sourceRoot":""}