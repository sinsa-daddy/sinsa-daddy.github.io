{"version":3,"file":"static/js/async/copilots/(term)/page.2cec45f6.js","sources":["./src/components/AurorianCard/index.tsx","./src/components/AuroriansTeam/index.tsx","./src/components/CopilotsTable/columns.tsx","./src/components/CopilotsTable/index.tsx","./src/containers/TermChanger.tsx","./src/containers/TermNotFound.tsx","./src/routes/copilots/[term]/page.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef } from 'react';\nimport { useModel } from '@modern-js/runtime/model';\nimport { type AurorianType } from '@sinsa/schema';\nimport { Badge, ConfigProvider, Rate } from 'antd';\nimport { clsx } from 'clsx';\nimport styles from './styles.module.less';\nimport { ClassURLMapper, ElementURLMapper, RarityMapper } from './constants';\nimport { AuroriansModel } from '@/models/aurorians';\n\ninterface AurorianCardProps {\n  name: string;\n  breakthrough?: number;\n  isReplaceable?: boolean;\n  sameSize?: boolean;\n}\n\nexport const AurorianCard = React.memo<AurorianCardProps>(\n  ({ name, breakthrough, isReplaceable, sameSize }) => {\n    const [{ auroriansMap }] = useModel(AuroriansModel);\n    const aurorian = useMemo(\n      () => auroriansMap[name] as AurorianType | undefined,\n      [auroriansMap, name],\n    );\n\n    const cardRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n      if (aurorian?.aurorian_name) {\n        import(`@/assets/skins/${aurorian.aurorian_name}.webp`)\n          .then(esm => {\n            if (typeof esm?.default === 'string') {\n              if (cardRef.current) {\n                cardRef.current.style.backgroundImage = `url(${esm.default})`;\n              }\n            }\n          })\n          .catch(() => {\n            // ignore\n          });\n      }\n    }, [aurorian?.aurorian_name]);\n\n    return (\n      <Badge.Ribbon\n        style={{\n          fontSize: '12px',\n          display: isReplaceable ? 'block' : 'none',\n          zIndex: 10000,\n        }}\n        text={isReplaceable ? 'ÂèØÊõø' : undefined}\n      >\n        <div\n          className={clsx(styles.AurorianCard, sameSize && styles.SameSize)}\n          ref={cardRef}\n        >\n          {aurorian?.class && aurorian?.attribute ? (\n            <div\n              className={clsx(\n                styles.MetaContainer,\n                sameSize && styles.SameSizeMeta,\n              )}\n            >\n              <img\n                className={styles.MetaClass}\n                alt={aurorian.class}\n                src={ClassURLMapper[aurorian.class]}\n              />\n              <div className={styles.MetaAttributeContainer}>\n                <img\n                  className={styles.MetaFirstAttribute}\n                  alt={aurorian.attribute}\n                  src={ElementURLMapper[aurorian.attribute]}\n                />\n                {aurorian.secondary_attribute ? (\n                  <img\n                    className={styles.MetaSecondAttribute}\n                    alt={aurorian.secondary_attribute}\n                    src={ElementURLMapper[aurorian.secondary_attribute]}\n                  />\n                ) : null}\n              </div>\n            </div>\n          ) : null}\n          <div className={styles.NameContainer}>\n            <div title={aurorian?.aurorian_name}>\n              {aurorian?.aurorian_cn_name}\n            </div>\n\n            {typeof breakthrough === 'number' && aurorian?.rarity ? (\n              <ConfigProvider\n                theme={{\n                  components: {\n                    Rate: {\n                      starBg: 'white',\n                      starSize: 8,\n                    },\n                  },\n                }}\n              >\n                <Rate\n                  className={styles.BreakThrough}\n                  disabled\n                  value={breakthrough}\n                  count={RarityMapper[aurorian.rarity]}\n                />\n              </ConfigProvider>\n            ) : null}\n          </div>\n        </div>\n      </Badge.Ribbon>\n    );\n  },\n);\n","import type { CopilotType } from '@sinsa/schema';\nimport React from 'react';\nimport { AurorianCard } from '../AurorianCard';\nimport styles from './styles.module.less';\n\ninterface AuroriansTeamProps {\n  aurorianSummaries: CopilotType['aurorian_summaries'];\n}\n\nexport const AuroriansTeam: React.FC<AuroriansTeamProps> = ({\n  aurorianSummaries,\n}) => {\n  return (\n    <div className={styles.AuroriansTeam}>\n      {aurorianSummaries.map(\n        ({ aurorian_name, breakthrough, is_replaceable }) => {\n          return (\n            <AurorianCard\n              key={aurorian_name}\n              name={aurorian_name}\n              breakthrough={breakthrough}\n              isReplaceable={is_replaceable}\n            />\n          );\n        },\n      )}\n    </div>\n  );\n};\n","import type { ProColumns } from '@ant-design/pro-components';\nimport type { CopilotType } from '@sinsa/schema';\nimport { Tooltip, Typography } from 'antd';\nimport { AuroriansTeam } from '../AuroriansTeam';\n\nexport interface TableParams {\n  title?: CopilotType['title'];\n  author?: CopilotType['author'];\n  term?: `${number}`;\n  dataSource?: CopilotType[];\n  score?: [number, undefined] | [number, number] | [undefined, number];\n}\n\nexport const copilotsColumns: ProColumns<CopilotType>[] = [\n  {\n    title: 'ÂÖâÁÅµÈÖçÁΩÆ',\n    dataIndex: 'aurorian_summaries',\n    hideInSearch: true,\n    render(_, entity) {\n      return <AuroriansTeam aurorianSummaries={entity.aurorian_summaries} />;\n    },\n    width: 80 * 5 + 24,\n  },\n  {\n    title: 'ÁªìÁÆóÂàÜÊï∞',\n    dataIndex: 'score',\n    valueType: 'digit',\n    hideInSearch: true,\n    width: 130,\n  },\n  {\n    title: '‰ΩúËÄÖ',\n    dataIndex: 'author',\n    valueType: 'select',\n    hideInSearch: true,\n    ellipsis: true,\n    width: 160,\n    renderText(dom, entity) {\n      return (\n        <>\n          {dom}\n          <Tooltip title={entity.description}>\n            {entity.description ? 'üóí' : null}\n          </Tooltip>\n        </>\n      );\n    },\n  },\n  {\n    title: 'Ê†áÈ¢ò',\n    dataIndex: 'title',\n    ellipsis: true,\n    render(dom, entity) {\n      return (\n        <Typography.Link\n          href={`https://www.bilibili.com/video/${entity.bv}`}\n          target=\"_blank\"\n          title={entity.title}\n        >\n          {entity.title}\n        </Typography.Link>\n      );\n    },\n  },\n  {\n    title: '‰∏ä‰º†Êó∂Èó¥',\n    dataIndex: 'upload_time',\n    valueType: 'dateTime',\n    width: 160,\n    hideInSearch: true,\n  },\n];\n","import { useCallback, useMemo, useRef } from 'react';\nimport type { ActionType } from '@ant-design/pro-components';\nimport { ProTable } from '@ant-design/pro-components';\nimport type { CopilotType } from '@sinsa/schema';\nimport { type TableParams, copilotsColumns } from './columns';\n\ninterface CopilotsTableProps {\n  dataSource: CopilotType[];\n  term?: `${number}`;\n}\n\nexport function copilotRowKey(c: CopilotType) {\n  return c.bv;\n}\n\nconst TABLE_CONST_PROPS = {\n  pagination: {\n    pageSize: 5,\n    size: 'default',\n    position: ['bottomCenter'] as any,\n  },\n  scroll: { x: 'max-content', scrollToFirstRowOnChange: true },\n} as const;\n\nexport const CopilotsTable: React.FC<CopilotsTableProps> = ({\n  dataSource,\n  term,\n}) => {\n  const actionRef = useRef<ActionType>();\n\n  const deps = useMemo(\n    (): TableParams => ({ term, dataSource }),\n    [term, dataSource],\n  );\n\n  const request = useCallback(async (params: TableParams) => {\n    return {\n      data:\n        params.dataSource?.filter(item => {\n          let ok = true;\n          if (params.title) {\n            ok = item.title.includes(params.title);\n          }\n          // min\n          if (typeof params.score?.[0] === 'number') {\n            ok = params.score[0] <= item.score;\n          }\n\n          // max\n          if (typeof params.score?.[1] === 'number') {\n            ok = item.score <= params.score[1];\n          }\n          return ok;\n        }) ?? [],\n      success: true,\n    };\n  }, []);\n\n  return (\n    <ProTable<CopilotType, TableParams>\n      rowKey={copilotRowKey}\n      actionRef={actionRef}\n      columns={copilotsColumns}\n      params={deps}\n      request={request}\n      {...TABLE_CONST_PROPS}\n    />\n  );\n};\n","import { useModel } from '@modern-js/runtime/model';\nimport { Select } from 'antd';\nimport { useNavigate, useParams } from '@modern-js/runtime/router';\nimport { TermsModel } from '@/models/terms';\nimport { RoutePath } from '@/components/MyLayout/constants';\n\nexport const TermChanger: React.FC<{\n  pathFn: typeof RoutePath.Copilots | typeof RoutePath.Solutions;\n}> = ({ pathFn }) => {\n  const params = useParams<{ term: `${number}` }>();\n  const [terms] = useModel(TermsModel);\n  const navigate = useNavigate();\n\n  return (\n    <Select\n      value={params.term && Number.parseInt(params.term, 10)}\n      options={terms.termsOptions}\n      placeholder=\"ËçíÂÖ∏ÊúüÊï∞\"\n      onChange={(nextTerm: number) => {\n        navigate(pathFn(nextTerm));\n      }}\n    />\n  );\n};\n","import { useModel } from '@modern-js/runtime/model';\nimport { Button, Result } from 'antd';\nimport { Link } from '@modern-js/runtime/router';\nimport { TermsModel } from '@/models/terms';\nimport { RoutePath } from '@/components/MyLayout/constants';\n\nexport const TermNotFound: React.FC = () => {\n  const [{ firstTerm }] = useModel(TermsModel);\n\n  return (\n    <Result\n      status=\"404\"\n      title=\"ËçíÂÖ∏‰Ωú‰∏ö‰∏çËßÅ‰∫Ü\"\n      subTitle=\"Ê£ÄÊü•ÈìæÊé•ÊòØÂê¶Ê≠£Á°ÆÊàñËøîÂõûÊúÄËøëËçíÂÖ∏‰Ωú‰∏ö\"\n      extra={\n        firstTerm ? (\n          <Link to={RoutePath.Copilots(firstTerm.term)}>\n            <Button type=\"primary\">ËøîÂõûÊúÄËøë‰Ωú‰∏ö</Button>\n          </Link>\n        ) : (\n          <Link to={RoutePath.Home}>\n            <Button type=\"primary\">ËøîÂõûÈ¶ñÈ°µ</Button>\n          </Link>\n        )\n      }\n    />\n  );\n};\n","import { useParams } from '@modern-js/runtime/router';\nimport { useRequest } from 'ahooks';\nimport { PageContainer } from '@ant-design/pro-components';\nimport type { CopilotType } from '@sinsa/schema';\nimport { useMemo } from 'react';\nimport { TermNotFound } from '@/containers/TermNotFound';\nimport { TermChanger } from '@/containers/TermChanger';\nimport { CopilotsTable } from '@/components/CopilotsTable';\nimport { RoutePath } from '@/components/MyLayout/constants';\n\nconst CopilotsPage: React.FC = () => {\n  const params = useParams<{ term: `${number}` }>();\n\n  const { data, error, loading } = useRequest(\n    () =>\n      fetch(`/api/copilots/${params.term}.json`).then(\n        response =>\n          response.json() as Promise<Record<CopilotType['bv'], CopilotType>>,\n      ),\n    { refreshDeps: [params.term] },\n  );\n\n  const copilots = useMemo(() => Object.values(data ?? []), [data]);\n\n  if (error) {\n    return <TermNotFound />;\n  }\n\n  return (\n    <PageContainer\n      content={<TermChanger pathFn={RoutePath.Copilots} />}\n      title=\"‰Ωú‰∏öÂÖ®Ëßà\"\n      loading={loading}\n    >\n      <CopilotsTable term={params.term} dataSource={copilots} />\n    </PageContainer>\n  );\n};\n\nexport default CopilotsPage;\n"],"names":["AurorianCard","name","breakthrough","isReplaceable","sameSize","auroriansMap","useModel","AuroriansModel","aurorian","useMemo","cardRef","useRef","useEffect","aurorian_name","then","esm","default","current","style","backgroundImage","catch","Badge","fontSize","display","zIndex","text","undefined","className","clsx","ref","class","attribute","alt","src","ClassURLMapper","ElementURLMapper","secondary_attribute","title","aurorian_cn_name","rarity","ConfigProvider","theme","components","Rate","starBg","starSize","disabled","value","count","RarityMapper","AuroriansTeam","aurorianSummaries","map","is_replaceable","copilotsColumns","dataIndex","hideInSearch","render","_","entity","aurorian_summaries","width","valueType","ellipsis","renderText","dom","Tooltip","description","Typography","href","bv","target","copilotRowKey","c","TABLE_CONST_PROPS","pagination","pageSize","size","position","scroll","x","scrollToFirstRowOnChange","CopilotsTable","dataSource","term","actionRef","deps","request","useCallback","params","data","filter","item","ok","includes","score","success","ProTable","rowKey","columns","TermChanger","pathFn","useParams","terms","TermsModel","navigate","useNavigate","Select","Number","parseInt","options","termsOptions","placeholder","onChange","nextTerm","TermNotFound","firstTerm","Result","status","subTitle","extra","Link","to","RoutePath","Button","type","error","loading","useRequest","fetch","response","json","refreshDeps","copilots","Object","values","PageContainer","content"],"mappings":"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"}