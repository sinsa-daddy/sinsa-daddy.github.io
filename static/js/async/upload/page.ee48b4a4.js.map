{"version":3,"file":"static/js/async/upload/page.ee48b4a4.js","sources":["webpack://@sinsa/web/./src/components/LatestVideoCard/index.tsx","webpack://@sinsa/web/./src/components/LatestVideoCard/schemas/SearchVideo.ts","webpack://@sinsa/web/./src/components/LatestVideoCard/schemas/SimpleLatestCopilot.ts","webpack://@sinsa/web/./src/components/LatestVideoCard/useLatestVideo.ts","webpack://@sinsa/web/./src/components/UploadForm/AurorianTallCard/index.tsx","webpack://@sinsa/web/./src/components/UploadForm/AurorianTallCard/utils/getDefaultBreakthrough.ts","webpack://@sinsa/web/./src/components/UploadForm/AurorianTallCard/utils/normalizeRemark.ts","webpack://@sinsa/web/./src/components/UploadForm/CopilotSelector/index.tsx","webpack://@sinsa/web/./src/components/UploadForm/CopilotSelector/utils/getDefaultBreakthrough.ts","webpack://@sinsa/web/./src/components/UploadForm/VideoIframe/index.tsx","webpack://@sinsa/web/./src/components/UploadForm/hooks/useCheckVideoExist.ts","webpack://@sinsa/web/./src/components/UploadForm/hooks/usePostCopilot.ts","webpack://@sinsa/web/./src/components/UploadForm/hooks/useVideoInfo.ts","webpack://@sinsa/web/./src/components/UploadForm/index.tsx","webpack://@sinsa/web/./src/components/UploadForm/utils/ensure.ts","webpack://@sinsa/web/./src/components/UploadForm/utils/get-copilot-id.ts","webpack://@sinsa/web/./src/components/UploadForm/utils/preprocess.ts","webpack://@sinsa/web/./src/components/UploadForm/utils/rules.ts","webpack://@sinsa/web/./src/models/feishu.ts","webpack://@sinsa/web/./src/routes/upload/page.tsx","webpack://@sinsa/web/./src/views/UploadView/LarkLoginCard/index.tsx"],"sourcesContent":["/* eslint-disable no-nested-ternary */\n/* eslint-disable react/no-danger */\nimport { Button, Card, Flex, Tag, Tooltip, Typography } from 'antd';\nimport React, { useEffect, useImperativeHandle, useMemo, useRef } from 'react';\nimport { useModel } from '@modern-js/runtime/model';\nimport dayjs from 'dayjs';\nimport { first, maxBy, minBy } from 'lodash-es';\nimport { useRequest } from 'ahooks';\nimport { RelativeTimeText } from '../RelativeTimeText';\nimport { trimTitle } from '../utils';\nimport { useLatestVideo } from './useLatestVideo';\nimport styles from './styles.module.less';\nimport type { SimpleLatestCopilotType } from './schemas/SimpleLatestCopilot';\nimport type { SearchVideoType } from './schemas/SearchVideo';\nimport { FeishuModel } from '@/models/feishu';\nimport { GLOBAL_THEME } from '@/globalTheme';\n\ninterface LatestVideoCardProps {\n  onClickNewCard?: (newBvid: string) => void;\n  currentTermId?: string;\n}\n\ninterface LatestVideoCardRef {\n  refresh: () => void;\n  latestMaxAndMinScoreCopilots: {\n    maxScoreCopilot: SimpleLatestCopilotType | undefined;\n    minScoreCopilot: SimpleLatestCopilotType | undefined;\n  };\n  latestVideo: SearchVideoType | undefined;\n}\n\nexport function useLatestVideoCardRef() {\n  const ref = useRef<LatestVideoCardRef>(null);\n  return ref;\n}\n\nexport const LatestVideoCard = React.forwardRef<\n  LatestVideoCardRef,\n  LatestVideoCardProps\n>(({ onClickNewCard, currentTermId }, ref) => {\n  const {\n    loadingLatestCopilots,\n    loadingLatestVideos,\n    getLatestCopilotsAsync,\n    getLatestVideosAsync,\n    latestCopilots,\n    latestVideos,\n    refresh,\n  } = useLatestVideo();\n  const [{ isLogin }] = useModel(FeishuModel);\n\n  useEffect(() => {\n    if (isLogin) {\n      getLatestCopilotsAsync();\n      getLatestVideosAsync();\n    }\n  }, [isLogin]);\n\n  const latestMaxAndMinScoreCopilots = useMemo(() => {\n    const currentTermCopilots = latestCopilots?.filter(\n      c => c.term_id === currentTermId,\n    );\n    const maxScoreCopilot = maxBy(currentTermCopilots, c => c.score);\n    const minScoreCopilot = minBy(currentTermCopilots, c => c.score);\n\n    return {\n      maxScoreCopilot,\n      minScoreCopilot,\n    };\n  }, [latestCopilots, currentTermId]);\n\n  useImperativeHandle(\n    ref,\n    () => {\n      return {\n        refresh,\n        latestMaxAndMinScoreCopilots,\n        latestVideo: latestVideos?.result?.[0],\n      };\n    },\n    [refresh, latestMaxAndMinScoreCopilots, latestVideos?.result?.[0]?.bvid],\n  );\n\n  const { data, loading: loadingDenyList } = useRequest(async () => {\n    const list = await import('./deny-list.json');\n\n    return {\n      list: Array.from(list),\n    };\n  }, {});\n\n  if (!isLogin) {\n    return null;\n  }\n\n  return location.hostname === 'localhost' ? (\n    <Card\n      title=\"B站视频最新收录情况：最近 20 条按新发布排序搜索结果\"\n      loading={loadingLatestCopilots || loadingLatestVideos || loadingDenyList}\n      bodyStyle={{ overflow: 'auto', height: 400 }}\n      extra={\n        <Button\n          type=\"primary\"\n          loading={loadingLatestCopilots || loadingLatestVideos}\n          onClick={e => {\n            e.stopPropagation();\n            refresh();\n          }}\n        >\n          刷新\n        </Button>\n      }\n    >\n      {latestCopilots && latestVideos ? (\n        <Flex wrap=\"wrap\" gap=\"small\">\n          {latestVideos.result.map(video => {\n            const displayTitle = trimTitle(video.title);\n\n            const copilotInfo = latestCopilots.find(c =>\n              c.href.startsWith(video.bvid),\n            );\n\n            const onlyHitAuthor =\n              video.hit_columns.length === 1 &&\n              video.hit_columns.includes('author');\n\n            const tooShort = first(video.duration.split(':')) === '0';\n\n            const inDenyList = data?.list.includes(video.bvid);\n\n            return (\n              <Card\n                hoverable={!copilotInfo && !inDenyList}\n                className={styles.Card}\n                size=\"small\"\n                key={video.bvid}\n                cover={\n                  <div className={styles.CoverContainer}>\n                    <Flex className={styles.UploadedTagContainer} wrap=\"wrap\">\n                      {copilotInfo ? (\n                        <Tooltip\n                          title={`${copilotInfo?.created_by.name} 于 ${dayjs(\n                            copilotInfo?.created_time,\n                          ).format('YYYY-MM-DD HH:mm:ss')} 收录了此作业`}\n                        >\n                          <Tag color=\"green\">已收录</Tag>\n                        </Tooltip>\n                      ) : inDenyList ? null : (\n                        <Tag color={GLOBAL_THEME.primaryColor}>未收录</Tag>\n                      )}\n                      {onlyHitAuthor || tooShort ? (\n                        <Tag color=\"orange-inverse\">疑似非荒典作业</Tag>\n                      ) : null}\n                      {inDenyList ? <Tag color=\"gray\">无需收录</Tag> : null}\n                    </Flex>\n                    <img\n                      className={styles.CoverImage}\n                      referrerPolicy=\"no-referrer\"\n                      crossOrigin=\"anonymous\"\n                      alt={video.title}\n                      src={`${video.pic}@672w_378h_1c_!web-search-common-cover.webp`}\n                    />\n                    <div className={styles.Duration}>{video.duration}</div>\n                  </div>\n                }\n                onClick={e => {\n                  e.stopPropagation();\n                  if (!copilotInfo) {\n                    onClickNewCard?.(video.bvid);\n                  }\n                }}\n              >\n                <Flex className={styles.Author} align=\"center\">\n                  <Typography.Text strong>{video.author}</Typography.Text>\n                  <Typography.Text className={styles.Dot} type=\"secondary\">\n                    ·\n                  </Typography.Text>\n                  <RelativeTimeText time={new Date(video.pubdate)} />\n                </Flex>\n                <div className={styles.Title}>\n                  <Typography.Link\n                    href={`https://www.bilibili.com/video/${video.bvid}`}\n                    target=\"_blank\"\n                    title={video.title}\n                    ellipsis={true}\n                    onClick={e => e.stopPropagation()}\n                  >\n                    <span dangerouslySetInnerHTML={{ __html: displayTitle }} />\n                  </Typography.Link>\n                </div>\n              </Card>\n            );\n          })}\n        </Flex>\n      ) : null}\n    </Card>\n  ) : null;\n});\n","import { z } from '@sinsa/schema';\n\nexport const SearchVideoSchema = z.object({\n  type: z.literal('video'),\n  author: z.string(),\n  pic: z.string(),\n  bvid: z.string().startsWith('BV'),\n  title: z.string(),\n  pubdate: z.number().transform(v => v * 1000),\n  hit_columns: z.array(z.enum(['title', 'tag', 'author', 'description'])),\n  duration: z.string(),\n});\n\nexport type SearchVideoType = z.infer<typeof SearchVideoSchema>;\n\nexport const SearchVideoResultSchema = z.object({\n  seid: z.string(),\n  page: z.number(),\n  pagesize: z.number(),\n  numResults: z.number(),\n  numPages: z.number(),\n  result: z.array(SearchVideoSchema),\n});\n\nexport type SearchVideoResultType = z.infer<typeof SearchVideoResultSchema>;\n","import { CopilotNextUserSchema, z } from '@sinsa/schema';\n\nexport const SimpleLatestCopilotSchema = z.object({\n  created_time: z.coerce.date(),\n  created_by: z.preprocess(\n    val => (typeof val === 'string' ? JSON.parse(val) : val),\n    CopilotNextUserSchema,\n  ),\n  copilot_id: z.string(),\n  score: z.coerce.number(),\n  term_id: z.string(),\n  href: z.string(),\n});\n\nexport interface SimpleLatestCopilotType\n  extends z.infer<typeof SimpleLatestCopilotSchema> {}\n\nexport const SimpleLatestCopilotsResultSchema = z.array(\n  SimpleLatestCopilotSchema,\n);\n","import { useRequest } from 'ahooks';\nimport { useCallback } from 'react';\nimport { SearchVideoResultSchema } from './schemas/SearchVideo';\nimport { SimpleLatestCopilotsResultSchema } from './schemas/SimpleLatestCopilot';\nimport { getLatestCopilots, getLatestVideo } from '@/services/http';\n\nexport function useLatestVideo() {\n  const {\n    loading: loadingLatestVideos,\n    runAsync: getLatestVideosAsync,\n    data: latestVideos,\n    refresh: refreshLatestVideos,\n  } = useRequest(\n    async () => {\n      try {\n        const data = await getLatestVideo();\n\n        return SearchVideoResultSchema.parse(data);\n      } catch (error) {\n        console.log('parse error', error);\n      }\n      return undefined;\n    },\n    {\n      manual: true,\n    },\n  );\n\n  const {\n    data: latestCopilots,\n    loading: loadingLatestCopilots,\n    runAsync: getLatestCopilotsAsync,\n    refresh: refreshLatestCopilots,\n  } = useRequest(\n    async () => {\n      try {\n        const data = await getLatestCopilots({ pageSize: 30 });\n        return SimpleLatestCopilotsResultSchema.parse(data);\n      } catch (error) {\n        console.log('parse error', error);\n      }\n      return undefined;\n    },\n    { manual: true },\n  );\n\n  const refresh = useCallback(() => {\n    refreshLatestCopilots();\n    refreshLatestVideos();\n  }, []);\n\n  return {\n    latestVideos,\n    loadingLatestVideos,\n    getLatestVideosAsync,\n    latestCopilots,\n    loadingLatestCopilots,\n    getLatestCopilotsAsync,\n    refresh,\n  };\n}\n","import type React from 'react';\nimport { useMemo } from 'react';\nimport { useModel } from '@modern-js/runtime/model';\nimport { Flex, InputNumber, Radio, Rate, Slider, Space, Switch } from 'antd';\nimport type {\n  AurorianNextType,\n  AurorianRequirementRemarkType,\n} from '@sinsa/schema';\nimport { produce } from 'immer';\nimport styles from './styles.module.less';\nimport { getDefaultTooltips } from './utils/getDefaultBreakthrough';\nimport { normalizeRemark } from './utils/normalizeRemark';\nimport { AuroriansModel } from '@/models/aurorians';\nimport { AdaptiveAurorianCard } from '@/components/AdaptiveAurorianCard';\n\ninterface AurorianTallCardProps {\n  id: string;\n  breakthrough?: number;\n  remark?: AurorianRequirementRemarkType;\n  onBreakthroughChange?: (b: number) => void;\n  onRemarkChange?: (r: AurorianRequirementRemarkType | undefined) => void;\n}\n\nconst REPLCE_OPTIONS = [\n  { label: '可替', value: 'All' },\n  { label: '可替输出', value: 'DPS' },\n  { label: '可替位移', value: 'TP' },\n];\n\nconst ASC_OPTIONS = [\n  { label: '觉醒三', value: 3 },\n  { label: '觉醒二', value: 2 },\n  { label: '觉醒一', value: 1 },\n  { label: '未觉醒', value: 0 },\n];\n\nconst RFN_OPTIONS = [\n  { label: '精炼三', value: 3 },\n  { label: '精炼二', value: 2 },\n  { label: '精炼一', value: 1 },\n  { label: '未精炼', value: 0 },\n];\n\nconst MARKS = {\n  1: '1',\n  10: '10',\n  20: '20',\n  30: '30',\n  40: '40',\n  50: '50',\n  60: '60',\n  80: '80',\n};\n\nexport const AurorianTallCard: React.FC<AurorianTallCardProps> = ({\n  id: name,\n  breakthrough,\n  remark,\n  onBreakthroughChange,\n  onRemarkChange,\n}) => {\n  const [{ auroriansMap }] = useModel(AuroriansModel);\n  const aurorian = useMemo(\n    () => auroriansMap[name] as AurorianNextType | undefined,\n    [auroriansMap, name],\n  );\n\n  const hasLevel = Object.keys(remark?.level ?? {}).length > 0;\n  return (\n    <Flex vertical align=\"center\" gap={8}>\n      <div className={styles.AdaptiveContainer}>\n        <AdaptiveAurorianCard\n          readOnly\n          aurorianId={name}\n          remark={remark}\n          breakthrough={breakthrough}\n        />\n      </div>\n\n      {typeof breakthrough === 'number' && aurorian?.rarity ? (\n        <Rate\n          className={styles.BreakThrough}\n          value={breakthrough}\n          count={aurorian.rarity}\n          onChange={onBreakthroughChange}\n          tooltips={getDefaultTooltips(aurorian.rarity)}\n        />\n      ) : null}\n      <Flex align=\"center\" gap={2} wrap={'wrap'}>\n        <Switch\n          checkedChildren=\"可替换\"\n          unCheckedChildren=\"不可替换\"\n          checked={remark?.replace?.type === 'any'}\n          onChange={val => {\n            onRemarkChange?.(\n              normalizeRemark(\n                produce(remark ?? {}, draft => {\n                  if (val) {\n                    draft.replace = {\n                      type: 'any',\n                      any: 'All',\n                    };\n                  } else {\n                    delete draft.replace;\n                  }\n                }),\n              ),\n            );\n          }}\n        />\n        {remark?.replace?.type === 'any' ? (\n          <Radio.Group\n            size=\"small\"\n            value={remark?.replace?.any}\n            options={REPLCE_OPTIONS}\n            optionType=\"button\"\n            onChange={e => {\n              onRemarkChange?.(\n                normalizeRemark(\n                  produce(remark ?? {}, draft => {\n                    if (draft.replace?.type === 'any') {\n                      draft.replace.any = e.target.value;\n                    }\n                  }),\n                ),\n              );\n            }}\n          />\n        ) : null}\n      </Flex>\n      {typeof aurorian?.rarity === 'number' && aurorian.rarity >= 4 ? (\n        <Flex align=\"center\" gap={6} wrap={'wrap'} vertical={true}>\n          <Switch\n            checkedChildren=\"标注练度\"\n            unCheckedChildren=\"不标注练度\"\n            checked={hasLevel}\n            onChange={val => {\n              onRemarkChange?.(\n                normalizeRemark(\n                  produce(remark ?? {}, draft => {\n                    if (val) {\n                      draft.level = {\n                        asc: 3,\n                        lv: 80,\n                        eq: 0,\n                        rfn: 0,\n                        aff: 0,\n                      };\n                    } else {\n                      delete draft.level;\n                    }\n                  }),\n                ),\n              );\n            }}\n          />\n          {hasLevel ? (\n            <Flex align=\"center\" gap={2} wrap={'wrap'} vertical={true}>\n              <Radio.Group\n                size=\"small\"\n                optionType=\"button\"\n                disabled\n                value={remark?.level?.asc ?? 0}\n                options={ASC_OPTIONS}\n              />\n              <Space>\n                <Slider\n                  style={{ width: 180 }}\n                  value={remark?.level?.lv ?? 0}\n                  min={1}\n                  max={80}\n                  marks={MARKS}\n                  onChange={val => {\n                    onRemarkChange?.(\n                      normalizeRemark(\n                        produce(remark ?? {}, draft => {\n                          if (draft.level) {\n                            draft.level.lv = val;\n                            if (val < 80) {\n                              draft.level.rfn = 0;\n                            }\n                          }\n                        }),\n                      ),\n                    );\n                  }}\n                  step={null}\n                />\n                <InputNumber\n                  style={{ width: 60 }}\n                  size=\"small\"\n                  value={remark?.level?.lv ?? 0}\n                  min={1}\n                  max={80}\n                  onChange={val => {\n                    onRemarkChange?.(\n                      normalizeRemark(\n                        produce(remark ?? {}, draft => {\n                          if (draft.level) {\n                            draft.level.lv = val ?? 0;\n                          }\n                        }),\n                      ),\n                    );\n                  }}\n                />\n              </Space>\n              {remark?.level?.lv === 80 ? (\n                <Radio.Group\n                  size=\"small\"\n                  optionType=\"button\"\n                  value={remark?.level?.rfn ?? 0}\n                  options={RFN_OPTIONS}\n                  onChange={val => {\n                    onRemarkChange?.(\n                      normalizeRemark(\n                        produce(remark ?? {}, draft => {\n                          if (draft.level) {\n                            draft.level.rfn = val.target.value;\n                          }\n                        }),\n                      ),\n                    );\n                  }}\n                />\n              ) : null}\n            </Flex>\n          ) : null}\n        </Flex>\n      ) : null}\n    </Flex>\n  );\n};\n","import { memoize } from 'lodash-es';\n\nexport const getDefaultTooltips = memoize((rarity: number) => {\n  switch (rarity) {\n    case 6:\n      return ['零', '零', '一', '一', '一', '满'].map(txt => `${txt}破`);\n    case 5:\n      return ['零', '一', '一', '一', '满'].map(txt => `${txt}破`);\n    case 4:\n      return ['零', '零', '零', '满'].map(txt => `${txt}破`);\n    case 3:\n      return ['零', '零', '满'].map(txt => `${txt}破`);\n    case 2:\n      return ['零', '满'].map(txt => `${txt}破`);\n    case 1:\n      return ['满'].map(txt => `${txt}破`);\n    default:\n      return [];\n  }\n});\n","import type { AurorianRequirementRemarkType } from '@sinsa/schema';\n\nexport function normalizeRemark(remark?: AurorianRequirementRemarkType) {\n  if (remark && Object.keys(remark).length === 0) {\n    return undefined;\n  }\n  return remark;\n}\n","import { useModel } from '@modern-js/runtime/model';\nimport { Flex, Select } from 'antd';\nimport { intersection } from 'lodash-es';\nimport { produce } from 'immer';\nimport type { AurorianRequirementType } from '@sinsa/schema';\nimport styles from './styles.module.less';\nimport { getDefaultBreakthrough } from './utils/getDefaultBreakthrough';\nimport { AuroriansModel, filterAuroriansOption } from '@/models/aurorians';\nimport { AurorianTallCard } from '@/components/UploadForm/AurorianTallCard';\n\ninterface CopilotSelector {\n  value?: AurorianRequirementType[];\n  onChange?: (val: AurorianRequirementType[]) => void;\n}\n\nexport const CopilotnSelector: React.FC<CopilotSelector> = ({\n  value,\n  onChange,\n}) => {\n  const [{ auroriansOptions, auroriansMap }] = useModel(AuroriansModel);\n  const multiSelectValue = value?.map(item => item.aurorian_id);\n  return (\n    <Flex vertical gap={8}>\n      <Select\n        mode=\"multiple\"\n        options={auroriansOptions}\n        placeholder=\"支持按拼音搜索, 比如 ad 可以搜到 安顿\"\n        showSearch\n        allowClear={false}\n        value={value?.map(item => item.aurorian_id)}\n        filterOption={filterAuroriansOption}\n        onChange={newVal => {\n          const commonValues = intersection(multiSelectValue, newVal);\n          const remainEntity = value?.filter(item =>\n            commonValues.includes(item.aurorian_id),\n          );\n          onChange?.(\n            newVal.slice(0, 5).map(newId => {\n              const oldEntity = remainEntity?.find(\n                entity => entity.aurorian_id === newId,\n              );\n              if (oldEntity) {\n                return { ...oldEntity };\n              }\n              const targetAurorian = auroriansMap[newId];\n\n              return {\n                aurorian_id: newId,\n                breakthrough: getDefaultBreakthrough(targetAurorian.rarity),\n                // is_replaceable: false,\n              } as AurorianRequirementType;\n            }),\n          );\n        }}\n      />\n\n      <Flex className={styles.AuroriansTeam} wrap=\"wrap\" gap={16}>\n        {value?.map(({ aurorian_id, breakthrough, remark }, index) => {\n          return (\n            <AurorianTallCard\n              key={aurorian_id}\n              id={aurorian_id}\n              breakthrough={breakthrough}\n              remark={remark}\n              onBreakthroughChange={bt => {\n                onChange?.(\n                  produce(value, draft => {\n                    if (draft) {\n                      draft[index].breakthrough = bt;\n                    }\n                  }),\n                );\n              }}\n              onRemarkChange={r => {\n                onChange?.(\n                  produce(value, draft => {\n                    if (draft) {\n                      draft[index].remark = r;\n                    }\n                  }),\n                );\n              }}\n            />\n          );\n        })}\n      </Flex>\n    </Flex>\n  );\n};\n","import { memoize } from 'lodash-es';\n\nexport const getDefaultBreakthrough = memoize((rarity: number) => {\n  switch (rarity) {\n    case 6:\n      return 2;\n    case 5:\n      return 1;\n    case 4:\n      return 4;\n    case 3:\n      return 3;\n    case 2:\n      return 2;\n    case 1:\n      return 1;\n    default:\n      return 0;\n  }\n});\n","import React, { useMemo } from 'react';\n\ninterface VideoIframeProps {\n  bvid?: string;\n}\n\nexport const VideoIframe = React.memo<VideoIframeProps>(({ bvid }) => {\n  const url = useMemo(() => {\n    if (typeof bvid === 'string') {\n      const src = new URL('https://player.bilibili.com/player.html');\n      src.searchParams.append('bvid', bvid);\n      return src.href;\n    }\n    return undefined;\n  }, [bvid]);\n\n  if (url) {\n    return (\n      <iframe\n        src={url}\n        scrolling=\"no\"\n        frameBorder=\"no\"\n        style={{ border: 0, width: 700, height: 420 }}\n      ></iframe>\n    );\n  }\n\n  return null;\n});\n","import { useRequest } from 'ahooks';\nimport type { getCopilotId } from '../utils/get-copilot-id';\nimport { checkVideoExist } from '@/services/http';\n\nexport function useCheckVideoExist() {\n  const { loading: loadingCheckVideoExist, runAsync: check } = useRequest(\n    async (args: Parameters<typeof getCopilotId>[0]) => {\n      return checkVideoExist(args);\n    },\n    {\n      manual: true,\n    },\n  );\n\n  return {\n    loadingCheckVideoExist,\n    check,\n  };\n}\n","import { useRequest } from 'ahooks';\nimport type { CopilotNextType } from '@sinsa/schema';\nimport { toFeishuCopilotWithoutCreatedInfo } from '@sinsa/schema';\nimport { postCopilot } from '@/services/http';\n\nexport function usePostCopilot() {\n  const { loading: loadingPostCopilot, runAsync: postCopilotAsync } =\n    useRequest(\n      async (\n        submitCopilot: Omit<CopilotNextType, 'created_time' | 'created_by'>,\n        { triggerAction }: { triggerAction?: boolean },\n      ) => {\n        const remoteCopilot = toFeishuCopilotWithoutCreatedInfo(submitCopilot);\n        const result = await postCopilot(remoteCopilot, { triggerAction });\n\n        return result;\n      },\n      { manual: true },\n    );\n\n  return {\n    loadingPostCopilot,\n    postCopilotAsync,\n  };\n}\n","import { useRequest } from 'ahooks';\nimport { getVideoInfo } from '@/services/http';\n\nexport function useVideoInfo() {\n  const { data, loading, runAsync, mutate } = useRequest(\n    async bv => {\n      const result = await getVideoInfo(bv);\n\n      return result;\n    },\n    { manual: true },\n  );\n\n  return {\n    videoInfo: data,\n    loadingVideoInfo: loading,\n    getVideoInfo: runAsync,\n    setVideoInfo: mutate,\n  };\n}\n","/* eslint-disable max-lines */\nimport {\n  FooterToolbar,\n  ProForm,\n  ProFormDateTimePicker,\n  ProFormDependency,\n  ProFormDigit,\n  ProFormRadio,\n  ProFormSelect,\n  ProFormSwitch,\n  ProFormText,\n  ProFormTextArea,\n} from '@ant-design/pro-components';\nimport { useModel } from '@modern-js/runtime/model';\nimport { Button, Card, Typography, notification } from 'antd';\nimport { useMemo } from 'react';\nimport numeral from 'numeral';\nimport { CopilotNextSchema, CopilotSourceType } from '@sinsa/schema';\nimport { LatestVideoCard, useLatestVideoCardRef } from '../LatestVideoCard';\nimport type { FormValues } from './types';\nimport { CopilotnSelector } from './CopilotSelector';\nimport styles from './styles.module.less';\nimport { useVideoInfo } from './hooks/useVideoInfo';\nimport { VideoIframe } from './VideoIframe';\nimport { AURORIAN_SUMMARIES_RULES, SCORE_RULES } from './utils/rules';\nimport { trimBV } from './utils/preprocess';\nimport { useCheckVideoExist } from './hooks/useCheckVideoExist';\nimport { usePostCopilot } from './hooks/usePostCopilot';\nimport { ensureKey } from './utils/ensure';\nimport { getCopilotId } from './utils/get-copilot-id';\nimport { TermsModel } from '@/models/terms';\nimport { FeishuModel } from '@/models/feishu';\n\nconst SourceTypeOptions = [\n  {\n    label: '哔哩哔哩',\n    value: CopilotSourceType.Bilibili,\n  },\n  {\n    label: 'Youtube',\n    value: CopilotSourceType.Youtube,\n    disabled: true,\n  },\n];\n\nexport const UploadForm: React.FC = () => {\n  const [{ termsOptions, latestTerm }] = useModel(TermsModel);\n  const [{ isLogin }] = useModel(FeishuModel);\n\n  const { videoInfo, loadingVideoInfo, getVideoInfo, setVideoInfo } =\n    useVideoInfo();\n\n  const { loadingCheckVideoExist, check } = useCheckVideoExist();\n\n  const { loadingPostCopilot, postCopilotAsync } = usePostCopilot();\n\n  const [form] = ProForm.useForm<FormValues>();\n\n  const initialValues: Partial<FormValues> = useMemo(() => {\n    const result: Partial<FormValues> = {\n      source_type: CopilotSourceType.Bilibili,\n    };\n    if (latestTerm?.term_id) {\n      result.term_id = latestTerm.term_id;\n    }\n    return result;\n  }, [latestTerm?.term_id]);\n\n  const latestVideoCardRef = useLatestVideoCardRef();\n\n  return (\n    <>\n      <LatestVideoCard\n        currentTermId={form.getFieldValue(ensureKey('term_id'))}\n        ref={latestVideoCardRef}\n        onClickNewCard={bvid => {\n          form.setFieldValue(ensureKey('href'), bvid);\n        }}\n      />\n      {isLogin ? (\n        <Card>\n          <ProForm<FormValues>\n            form={form}\n            initialValues={initialValues}\n            submitter={{\n              submitButtonProps: {\n                loading: loadingCheckVideoExist || loadingPostCopilot,\n              },\n              render: (_, dom) => (\n                <FooterToolbar className={styles.FootBar}>{dom}</FooterToolbar>\n              ),\n              searchConfig: {\n                // eslint-disable-next-line no-nested-ternary\n                submitText: loadingCheckVideoExist\n                  ? '校验重复中'\n                  : loadingPostCopilot\n                  ? '提交中'\n                  : '提交作业',\n              },\n            }}\n            onFinish={async (values: FormValues) => {\n              const submitValues = {\n                ...values,\n                copilot_id: getCopilotId(values),\n              };\n\n              const checkResult = await check(values);\n\n              if (checkResult?.total) {\n                notification.error({\n                  message: '撞车了',\n                  placement: 'bottom',\n                  duration: 3,\n                });\n                return;\n              }\n\n              console.log('开始提交', checkResult, submitValues);\n\n              // const isLatestVideo =\n              //   typeof latestVideoCardRef.current?.latestVideo?.bvid ===\n              //     'string' &&\n              //   values.href.startsWith(\n              //     latestVideoCardRef.current?.latestVideo?.bvid,\n              //   );\n\n              try {\n                const submitCopilot = await CopilotNextSchema.omit({\n                  created_by: true,\n                  created_time: true,\n                }).parseAsync(submitValues);\n                const result = await postCopilotAsync(submitCopilot, {\n                  triggerAction: values?.triggerUpdate ?? false,\n                });\n\n                if (result?.record?.record_id) {\n                  notification.success({\n                    message: `醒山小狗已经成功帮您添加了 ${result?.record?.fields?.author_name} 的一份作业, record_id 为 ${result?.record?.record_id}`,\n                  });\n                  form.resetFields();\n                  setVideoInfo(undefined);\n                  latestVideoCardRef.current?.refresh();\n                } else {\n                  notification.error({\n                    message: `没有上传成功 ${JSON.stringify(result, null, 2)}`,\n                  });\n                  console.log('upload failed', result, submitCopilot);\n                }\n              } catch (error) {\n                notification.error({\n                  message: `解析表单失败 ${JSON.stringify(error, null, 2)}`,\n                });\n                console.error('解析失败', error);\n              }\n            }}\n          >\n            <ProForm.Group>\n              <ProFormSelect\n                name={ensureKey('term_id')}\n                label=\"荒典期数\"\n                options={termsOptions}\n                rules={[{ required: true }]}\n                width={'sm'}\n                showSearch={false}\n              />\n              <ProFormRadio.Group\n                name={ensureKey('source_type')}\n                label=\"投稿平台\"\n                radioType=\"button\"\n                options={SourceTypeOptions}\n                rules={[{ required: true }]}\n              />\n            </ProForm.Group>\n            <ProForm.Group>\n              <ProFormText\n                name={ensureKey('href')}\n                label=\"BV号或B站视频链接\"\n                placeholder={\n                  'BVxxxxxxxxxx 或 https://www.bilibili.com/video/BVxxxxxxxxxx/'\n                }\n                validateTrigger=\"onBlur\"\n                width={'lg'}\n                fieldProps={{\n                  onChange(e) {\n                    const bvOrLink = e.target.value;\n                    trimBV(form, bvOrLink);\n                  },\n                }}\n                rules={[\n                  { required: true },\n                  { pattern: /^BV.+$/, message: 'BV号格式不正确' },\n                ]}\n                extra=\"小提示：点击上方未收录的视频卡片，能快速填入 BV 号\"\n              />\n              <ProForm.Item label=\" \">\n                <ProFormDependency name={[ensureKey('href')]}>\n                  {({ href }) => (\n                    <Button\n                      disabled={\n                        !isLogin ||\n                        !(typeof href === 'string' && href.startsWith('BV'))\n                      }\n                      type=\"primary\"\n                      loading={loadingVideoInfo}\n                      onClick={async e => {\n                        e.stopPropagation();\n                        const result = await getVideoInfo(href);\n                        console.log('result', result);\n\n                        if (result) {\n                          const { title, desc, owner, pubdate } = result;\n                          form.setFieldsValue({\n                            title,\n                            description: desc === '-' ? undefined : desc,\n                            author_id: String(owner.mid),\n                            author_name: owner.name,\n                            upload_time: pubdate.valueOf(),\n                          });\n                        }\n                      }}\n                    >\n                      读取哔哩哔哩投稿视频信息\n                    </Button>\n                  )}\n                </ProFormDependency>\n              </ProForm.Item>\n            </ProForm.Group>\n            <VideoIframe bvid={videoInfo?.bvid} />\n\n            <ProForm.Item\n              label=\"光灵阵容\"\n              name={ensureKey('aurorian_requirements')}\n              rules={AURORIAN_SUMMARIES_RULES}\n            >\n              <CopilotnSelector />\n            </ProForm.Item>\n\n            <ProFormDigit\n              label=\"结算分数\"\n              name={ensureKey('score')}\n              validateTrigger=\"onBlur\"\n              rules={SCORE_RULES}\n              min={0}\n              fieldProps={{\n                formatter: value => numeral(value).format('0,0'),\n                parser: str => numeral(str).value() ?? 0,\n                size: 'large',\n              }}\n              extra={\n                <ProFormDependency name={[ensureKey('score')]}>\n                  {partialValues => {\n                    const { score } = partialValues as Pick<\n                      FormValues,\n                      'score'\n                    >;\n                    if (\n                      latestVideoCardRef.current?.latestMaxAndMinScoreCopilots\n                        ?.maxScoreCopilot &&\n                      latestVideoCardRef.current?.latestMaxAndMinScoreCopilots\n                        .minScoreCopilot\n                    ) {\n                      if (\n                        score >=\n                        2 *\n                          latestVideoCardRef.current\n                            .latestMaxAndMinScoreCopilots.maxScoreCopilot.score\n                      ) {\n                        return (\n                          <Typography.Text type=\"warning\">\n                            录入的分数超过最近作业最高分两倍，请再次确认是否录入正确\n                          </Typography.Text>\n                        );\n                      }\n\n                      if (\n                        score <=\n                        0.5 *\n                          latestVideoCardRef.current\n                            .latestMaxAndMinScoreCopilots.minScoreCopilot.score\n                      ) {\n                        return (\n                          <Typography.Text type=\"warning\">\n                            录入的分数低于最近作业最低分的一半，请再次确认是否录入正确\n                          </Typography.Text>\n                        );\n                      }\n                    }\n\n                    return null;\n                  }}\n                </ProFormDependency>\n              }\n            />\n\n            <ProFormText\n              label=\"视频标题\"\n              name={ensureKey('title')}\n              rules={[{ required: true }]}\n            />\n\n            <ProForm.Group>\n              <ProFormDateTimePicker\n                label=\"视频发布时间\"\n                name={ensureKey('upload_time')}\n                rules={[{ required: true }]}\n              />\n              <ProFormText\n                label=\"作业作者\"\n                name={ensureKey('author_name')}\n                rules={[{ required: true }]}\n              />\n              <ProFormText\n                label=\"作业作者空间 ID\"\n                name={ensureKey('author_id')}\n                rules={[{ required: true }]}\n                placeholder={`space.bilibili.com/[这一段数字填进来]`}\n                width={'md'}\n              />\n              <ProFormTextArea\n                label=\"视频描述\"\n                name=\"description\"\n                width={'xl'}\n              />\n            </ProForm.Group>\n            <ProFormSwitch\n              label=\"是否触发网站更新\"\n              extra=\"一般用于收录到了最新视频时开启\"\n              name={ensureKey('triggerUpdate')}\n            />\n          </ProForm>\n        </Card>\n      ) : null}\n    </>\n  );\n};\n","import type { FormValues } from '../types';\n\nexport function ensureKey(key: keyof FormValues) {\n  return key;\n}\n","import type { FormValues } from '../types';\n\nexport function getCopilotId({\n  href,\n  aurorian_requirements,\n  term_id,\n}: Pick<FormValues, 'href' | 'aurorian_requirements' | 'term_id'>) {\n  if (href && aurorian_requirements && term_id) {\n    const url = new URL(`https://example.com/${href}`);\n    return `${term_id}_${url.pathname.slice(1)}_${\n      aurorian_requirements[0].aurorian_id\n    }_${aurorian_requirements[4].aurorian_id}`;\n  }\n  return undefined;\n}\n","import type { ProFormInstance } from '@ant-design/pro-components';\nimport type { FormValues } from '../types';\n\nexport function trimBV(\n  form: ProFormInstance<FormValues> | undefined,\n  bvOrLink?: string,\n) {\n  if (\n    typeof bvOrLink === 'string' &&\n    (bvOrLink.startsWith('https://') || bvOrLink.startsWith('http://'))\n  ) {\n    const bvResult = /\\/(BV[^/]+)\\/?/.exec(new URL(bvOrLink).pathname)?.[1];\n    if (typeof bvResult === 'string' && bvResult.startsWith('BV')) {\n      form?.setFieldValue('bv', bvResult);\n    }\n  }\n}\n","import type { Rule } from 'antd/es/form';\n\nexport const AURORIAN_SUMMARIES_RULES: Rule[] = [\n  {\n    async validator(_, array) {\n      if (Array.isArray(array) && array.length === 5) {\n        // pass\n      } else {\n        throw new Error('光灵数量必须满足 5 个');\n      }\n    },\n  },\n  { required: true },\n];\n\nexport const SCORE_RULES: Rule[] = [\n  { required: true },\n  {\n    async validator(_, value) {\n      if (typeof value === 'number' && value.toString().endsWith('0000')) {\n        throw new Error(\n          '不能填写粗略分数, 荒典作业分数必须精确到个位, 请拖动视频进度条到最后查看具体分数',\n        );\n      }\n    },\n  },\n  {\n    async validator(_, value) {\n      if (typeof value === 'number' && Number.isInteger(value) && value > 0) {\n        // pass\n      } else {\n        throw new Error('分数必须是正整数');\n      }\n\n      if (value >= 1e8) {\n        throw new Error('分数大于一亿分了，你要不再看看有没有填对？');\n      } else if (value <= 1e5) {\n        throw new Error('分数小于十万分，你要不要再看看有没有填对？');\n      }\n    },\n  },\n];\n","import { model } from '@modern-js/runtime/model';\nimport type { FeishuProfileType } from '@/schemas/feishu-profile';\n\nexport interface FeishuState {\n  profile?: FeishuProfileType;\n}\n\nexport const FeishuModel = model<FeishuState>('feishu').define({\n  state: {\n    profile: undefined,\n  },\n  computed: {\n    isLogin: state =>\n      typeof state.profile?.name === 'string' &&\n      typeof state.profile?.open_id === 'string',\n  },\n  actions: {},\n});\n","import { PageContainer } from '@ant-design/pro-components';\nimport { Flex } from 'antd';\nimport { UploadForm } from '@/components/UploadForm';\nimport { LarkLoginCard } from '@/views/UploadView/LarkLoginCard';\n\nconst UploadPage: React.FC = () => {\n  return (\n    <PageContainer\n      title=\"作业收录（内部版）\"\n      content=\"内部的收录同学可以使用此页面快速上传作业，之后会再提供 Chrome 插件提高效率（比心）\"\n    >\n      <Flex vertical gap=\"middle\">\n        <LarkLoginCard />\n        <UploadForm />\n      </Flex>\n    </PageContainer>\n  );\n};\n\nexport default UploadPage;\n","import { Link, useLocation } from '@modern-js/runtime/router';\nimport { Avatar, Button, Card, Space, Typography } from 'antd';\nimport { useEffect, useMemo, useState } from 'react';\nimport { useRequest } from 'ahooks';\nimport { useModel } from '@modern-js/runtime/model';\nimport {\n  LARK_SCOPE,\n  LOCAL_STORAGE_ACCESS_TOKEN,\n  UPLOAD_APP_ID,\n} from './constants';\nimport { RoutePath } from '@/views/GlobalLayout/constants';\nimport { getFeishuAccessToken, getFeishuProfile } from '@/services/http';\nimport { FeishuModel } from '@/models/feishu';\nimport { FeishuAccessTokenSchema } from '@/schemas/feishu-access-token';\n\nexport const LarkLoginCard: React.FC = () => {\n  const REDIRECT_URI = useMemo(() => {\n    return `${window.location.origin}${RoutePath.Upload}/`;\n  }, []);\n\n  const [larkpreLoginCode, setLarkpreLoginCode] = useState<string>();\n  const location = useLocation();\n\n  useEffect(() => {\n    const code = location.search\n      .slice(1)\n      .split('&')\n      .find(item => item.startsWith('code='))\n      ?.replace('code=', '');\n\n    if (code) {\n      setLarkpreLoginCode(code);\n    }\n  }, [location.search]);\n\n  const [{ profile }, { setProfile }] = useModel(FeishuModel);\n\n  const { data: maybeAccessToken, loading: loadingAccessToken } = useRequest(\n    async () => {\n      try {\n        const content = window.localStorage.getItem(LOCAL_STORAGE_ACCESS_TOKEN);\n        const tokenInfo = FeishuAccessTokenSchema.parse(\n          content ? JSON.parse(content) : null,\n        );\n        return tokenInfo;\n      } catch {\n        // ignore\n      }\n\n      if (larkpreLoginCode) {\n        const accessTokenInfo = await getFeishuAccessToken({\n          code: larkpreLoginCode,\n        });\n\n        setLarkpreLoginCode(undefined);\n        return accessTokenInfo;\n      }\n      return undefined;\n    },\n    {\n      refreshDeps: [larkpreLoginCode],\n      // onSuccess(_p) {\n      //   setProfile(_p);\n      // },\n    },\n  );\n\n  const { loading: loadingProfile } = useRequest(\n    async () => {\n      if (maybeAccessToken?.access_token) {\n        const profile = await getFeishuProfile();\n        setProfile(profile);\n      }\n    },\n    {\n      refreshDeps: [maybeAccessToken?.access_token],\n    },\n  );\n\n  const FEISHU_AUTH_URL = useMemo(() => {\n    const url = new URL(`https://open.feishu.cn/open-apis/authen/v1/authorize`);\n    url.searchParams.append('app_id', UPLOAD_APP_ID);\n    url.searchParams.append('redirect_uri', REDIRECT_URI);\n    url.searchParams.append('scope', LARK_SCOPE);\n\n    return url.href;\n  }, []);\n  return (\n    <Card loading={loadingAccessToken || loadingProfile}>\n      {profile ? (\n        <Card.Meta\n          avatar={<Avatar src={profile.avatar_url} />}\n          title={profile.name}\n          description=\"欢迎回来~ 您已授权，可以开始工作啦\"\n        />\n      ) : (\n        <Space>\n          <Typography.Text>\n            您好，我是作业提交醒山小狗，我需要您飞书授权才能工作\n          </Typography.Text>\n          <Link target=\"_self\" to={FEISHU_AUTH_URL}>\n            <Button type=\"primary\">去飞书授权</Button>\n          </Link>\n        </Space>\n      )}\n    </Card>\n  );\n};\n"],"names":["useLatestVideoCardRef","useRef","LatestVideoCard","ref","onClickNewCard","currentTermId","loadingLatestCopilots","loadingLatestVideos","getLatestCopilotsAsync","getLatestVideosAsync","latestCopilots","latestVideos","refresh","useLatestVideo","isLogin","useModel","FeishuModel","useEffect","latestMaxAndMinScoreCopilots","useMemo","currentTermCopilots","filter","c","term_id","maxScoreCopilot","maxBy","score","minScoreCopilot","minBy","useImperativeHandle","latestVideo","result","bvid","data","loading","loadingDenyList","useRequest","list","Array","from","location","hostname","Card","title","bodyStyle","overflow","height","extra","Button","type","onClick","e","stopPropagation","Flex","wrap","gap","map","video","displayTitle","trimTitle","copilotInfo","find","href","startsWith","onlyHitAuthor","hit_columns","length","includes","tooShort","first","duration","split","inDenyList","hoverable","className","size","cover","Tooltip","created_by","name","created_time","format","Tag","color","GLOBAL_THEME","referrerPolicy","crossOrigin","alt","src","pic","align","Typography","strong","author","RelativeTimeText","time","Date","pubdate","target","ellipsis","dangerouslySetInnerHTML","__html","SearchVideoSchema","z","transform","v","SearchVideoResultSchema","seid","page","pagesize","numResults","numPages","SimpleLatestCopilotSchema","val","JSON","parse","CopilotNextUserSchema","copilot_id","SimpleLatestCopilotsResultSchema","runAsync","refreshLatestVideos","getLatestVideo","error","console","log","manual","refreshLatestCopilots","getLatestCopilots","pageSize","useCallback","REPLCE_OPTIONS","label","value","ASC_OPTIONS","RFN_OPTIONS","MARKS","AurorianTallCard","id","breakthrough","remark","onBreakthroughChange","onRemarkChange","auroriansMap","AuroriansModel","aurorian","hasLevel","Object","keys","level","vertical","AdaptiveAurorianCard","readOnly","aurorianId","rarity","Rate","count","onChange","tooltips","getDefaultTooltips","Switch","checkedChildren","unCheckedChildren","checked","replace","normalizeRemark","produce","draft","any","Radio","options","optionType","asc","lv","eq","rfn","aff","disabled","Space","Slider","style","width","min","max","marks","step","InputNumber","memoize","txt","CopilotnSelector","auroriansOptions","multiSelectValue","item","aurorian_id","Select","mode","placeholder","showSearch","allowClear","filterOption","filterAuroriansOption","newVal","commonValues","intersection","remainEntity","slice","newId","oldEntity","entity","targetAurorian","getDefaultBreakthrough","index","bt","r","VideoIframe","url","URL","searchParams","append","scrolling","frameBorder","border","useCheckVideoExist","loadingCheckVideoExist","check","args","checkVideoExist","usePostCopilot","loadingPostCopilot","postCopilotAsync","submitCopilot","triggerAction","remoteCopilot","toFeishuCopilotWithoutCreatedInfo","postCopilot","useVideoInfo","mutate","bv","getVideoInfo","videoInfo","loadingVideoInfo","setVideoInfo","SourceTypeOptions","CopilotSourceType","UploadForm","termsOptions","latestTerm","TermsModel","form","ProForm","initialValues","source_type","latestVideoCardRef","getFieldValue","ensureKey","setFieldValue","submitter","submitButtonProps","render","_","dom","FooterToolbar","searchConfig","submitText","onFinish","values","submitValues","getCopilotId","checkResult","total","notification","message","placement","CopilotNextSchema","parseAsync","triggerUpdate","record","record_id","fields","author_name","resetFields","undefined","current","stringify","ProFormSelect","rules","required","ProFormRadio","radioType","ProFormText","validateTrigger","fieldProps","bvOrLink","trimBV","pattern","ProFormDependency","desc","owner","setFieldsValue","description","author_id","String","mid","upload_time","valueOf","AURORIAN_SUMMARIES_RULES","ProFormDigit","SCORE_RULES","formatter","parser","str","partialValues","ProFormDateTimePicker","ProFormTextArea","ProFormSwitch","key","aurorian_requirements","pathname","bvResult","exec","validator","array","isArray","Error","toString","endsWith","Number","isInteger","model","define","state","profile","computed","open_id","actions","PageContainer","content","LarkLoginCard","REDIRECT_URI","window","origin","RoutePath","larkpreLoginCode","setLarkpreLoginCode","useState","useLocation","code","search","setProfile","maybeAccessToken","loadingAccessToken","localStorage","getItem","LOCAL_STORAGE_ACCESS_TOKEN","FeishuAccessTokenSchema","accessTokenInfo","getFeishuAccessToken","refreshDeps","loadingProfile","access_token","getFeishuProfile","FEISHU_AUTH_URL","UPLOAD_APP_ID","LARK_SCOPE","avatar","Avatar","avatar_url","Link","to"],"mappings":"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"}