{"version":3,"file":"static/js/async/my-box/create/page.eb3f01e2.js","sources":["./src/components/AurorianBoxCard/index.tsx","./src/components/CheckControlAurorianBoxCard/index.tsx","./src/components/CreateMyBoxForm/index.tsx","./src/routes/my-box/create/page.tsx"],"sourcesContent":["import React, { useEffect, useMemo, useRef } from 'react';\nimport { useModel } from '@modern-js/runtime/model';\nimport { type AurorianType } from '@sinsa/schema';\nimport { ConfigProvider, Rate } from 'antd';\nimport {\n  ClassURLMapper,\n  ElementURLMapper,\n  RarityMapper,\n} from '../AurorianCard/constants';\nimport styles from './styles.module.less';\nimport { AuroriansModel } from '@/models/aurorians';\n\ninterface AurorianBoxCardProps {\n  name: string;\n  breakthrough: number;\n  onBreakthroughChange?: (breakthrough: number) => void;\n}\n\nexport const AurorianBoxCard = React.memo<AurorianBoxCardProps>(\n  ({ name, breakthrough, onBreakthroughChange }) => {\n    const [{ auroriansMap }] = useModel(AuroriansModel);\n    const aurorian = useMemo(\n      () => auroriansMap[name] as AurorianType | undefined,\n      [auroriansMap, name],\n    );\n\n    const cardRef = useRef<HTMLDivElement>(null);\n\n    useEffect(() => {\n      if (aurorian?.aurorian_name) {\n        import(`@/assets/skins/${aurorian.aurorian_name}.webp`)\n          .then(esm => {\n            if (typeof esm?.default === 'string') {\n              if (cardRef.current) {\n                cardRef.current.style.backgroundImage = `url(${esm.default})`;\n              }\n            }\n          })\n          .catch(() => {\n            // ignore\n          });\n      }\n    }, [aurorian?.aurorian_name]);\n\n    return (\n      <div className={styles.AurorianBoxCard} ref={cardRef}>\n        {aurorian?.class && aurorian?.attribute ? (\n          <div className={styles.MetaContainer}>\n            <img\n              className={styles.MetaClass}\n              alt={aurorian.class}\n              src={ClassURLMapper[aurorian.class]}\n            />\n            <div className={styles.MetaAttributeContainer}>\n              <img\n                className={styles.MetaFirstAttribute}\n                alt={aurorian.attribute}\n                src={ElementURLMapper[aurorian.attribute]}\n              />\n              {aurorian.secondary_attribute ? (\n                <img\n                  className={styles.MetaSecondAttribute}\n                  alt={aurorian.secondary_attribute}\n                  src={ElementURLMapper[aurorian.secondary_attribute]}\n                />\n              ) : null}\n            </div>\n          </div>\n        ) : null}\n        <div className={styles.NameContainer}>\n          <div title={aurorian?.aurorian_name}>\n            {aurorian?.aurorian_cn_name}\n          </div>\n\n          {aurorian?.rarity ? (\n            <ConfigProvider\n              theme={{\n                components: {\n                  Rate: {\n                    starBg: 'white',\n                    starSize: 16,\n                  },\n                },\n              }}\n            >\n              <Rate\n                className={styles.BreakThrough}\n                value={breakthrough}\n                count={RarityMapper[aurorian.rarity]}\n                onChange={t => {\n                  onBreakthroughChange?.(t);\n                }}\n              />\n            </ConfigProvider>\n          ) : null}\n        </div>\n      </div>\n    );\n  },\n);\n","import { CheckCard } from '@ant-design/pro-card';\nimport { useState } from 'react';\nimport { AurorianBoxCard } from '../AurorianBoxCard';\n\ninterface CheckControlAurorianBoxCardProps {\n  name: string;\n}\n\nexport const CheckControlAurorianBoxCard: React.FC<\n  CheckControlAurorianBoxCardProps\n> = ({ name, ...rest }) => {\n  const [breakthrough, setBreakthrough] = useState(0);\n  return (\n    <CheckCard\n      {...rest}\n      value={{ name, breakthrough }}\n      style={{\n        width: 110,\n        height: 160,\n        boxSizing: 'border-box',\n        overflow: 'hidden',\n      }}\n      cover={\n        <AurorianBoxCard\n          name={name}\n          breakthrough={breakthrough}\n          onBreakthroughChange={setBreakthrough}\n        />\n      }\n    />\n  );\n};\n","import {\n  type ProFormInstance,\n  StepsForm,\n  ProFormText,\n} from '@ant-design/pro-form';\nimport { useModel } from '@modern-js/runtime/model';\nimport { useMemo, useRef } from 'react';\nimport { groupBy } from 'lodash';\nimport { Form } from 'antd';\nimport { CheckCard } from '@ant-design/pro-card';\nimport { AurorianAttributeType } from '@sinsa/schema';\nimport { CheckControlAurorianBoxCard } from '../CheckControlAurorianBoxCard';\nimport { AuroriansModel } from '@/models/aurorians';\n\nexport const CreateMyBoxForm: React.FC = () => {\n  const formRef = useRef<ProFormInstance>();\n  const [{ auroriansMap }] = useModel(AuroriansModel);\n\n  const chunks = useMemo(() => {\n    return groupBy(Object.values(auroriansMap), item => item.attribute);\n  }, [auroriansMap]);\n\n  console.log('chunks', chunks);\n  return (\n    <StepsForm formRef={formRef}>\n      <StepsForm.StepForm title=\"完成 Box 名称\">\n        <ProFormText\n          name=\"title\"\n          label=\"Box 名称\"\n          placeholder=\"给 Box 取一个好听的名字\"\n          rules={[{ required: true }]}\n        />\n      </StepsForm.StepForm>\n      <StepsForm.StepForm\n        title=\"选择火属性光灵\"\n        onValuesChange={changed => {\n          console.log('changed', changed);\n        }}\n      >\n        <Form.Item name={'fire'}>\n          <CheckCard.Group multiple>\n            {chunks[AurorianAttributeType.Fire].map(aurorian => (\n              <CheckControlAurorianBoxCard\n                key={aurorian.aurorian_name}\n                name={aurorian.aurorian_name}\n              />\n            ))}\n          </CheckCard.Group>\n        </Form.Item>\n      </StepsForm.StepForm>\n    </StepsForm>\n  );\n};\n","import { PageContainer } from '@ant-design/pro-layout';\nimport { CreateMyBoxForm } from '@/components/CreateMyBoxForm';\n\nconst CreateMyBoxPage: React.FC = () => {\n  return (\n    <PageContainer title=\"创建自定义 Box\">\n      <CreateMyBoxForm />\n    </PageContainer>\n  );\n};\n\nexport default CreateMyBoxPage;\n"],"names":["AurorianBoxCard","name","breakthrough","onBreakthroughChange","auroriansMap","useModel","AuroriansModel","aurorian","useMemo","cardRef","useRef","useEffect","aurorian_name","then","esm","default","current","style","backgroundImage","catch","className","ref","class","attribute","alt","src","ClassURLMapper","ElementURLMapper","secondary_attribute","title","aurorian_cn_name","rarity","ConfigProvider","theme","components","Rate","starBg","starSize","value","count","RarityMapper","onChange","t","CheckControlAurorianBoxCard","rest","setBreakthrough","useState","CheckCard","width","height","boxSizing","overflow","cover","CreateMyBoxForm","formRef","chunks","groupBy","Object","values","item","console","log","StepsForm","ProFormText","label","placeholder","rules","required","onValuesChange","changed","Form","multiple","AurorianAttributeType","map","PageContainer"],"mappings":";qkCAkBO,IAAMA,EAAkB,QAAU,CACvC,AAAC,QAAEC,KAAAA,CAAI,CAAEC,aAAAA,CAAY,CAAEC,qBAAAA,CAAoB,CAAE,GACrC,CAAC,CAAEC,aAAAA,CAAY,CAAE,CAAC,CAAG,KAAAC,QAAA,EAAS,EAAAC,cAAc,EAC5CC,EAAW,KAAAC,OAAA,EACf,IAAMJ,CAAY,CAACH,EAAK,CACxB,CAACG,EAAcH,EAAK,EAGhBQ,EAAU,KAAAC,MAAA,EAAuB,MAkBvC,MAhBA,KAAAC,SAAA,EAAU,KACJJ,CAAAA,MAAAA,EAAA,OAAAA,EAAUK,aAAa,AAAD,GACxB,WAAO,AAAC,kBAAwC,OAAvBL,EAASK,aAAa,CAAC,0CAC7CC,IAAI,CAAC,AAAAC,IACwB,UAAxB,MAAOA,CAAAA,MAAAA,EAAA,OAAAA,EAAKC,OAAO,AAAD,GAChBN,EAAQO,OAAO,EACjBP,CAAAA,EAAQO,OAAO,CAACC,KAAK,CAACC,eAAe,CAAI,OAAkB,OAAZJ,EAAIC,OAAO,CAAC,KAGjE,GACCI,KAAK,CAAC,KAEP,EAEN,EAAG,CAACZ,MAAAA,EAAA,OAAAA,EAAUK,aAAa,CAAC,EAG1B,WAAC,OAAIQ,UAAW,iBAAsB,CAAEC,IAAKZ,YAC1C,AAAAF,CAAAA,MAAAA,EAAA,OAAAA,EAAUe,KAAK,AAAD,GAAKf,CAAAA,MAAAA,EAAA,OAAAA,EAAUgB,SAAS,AAAD,EACpC,WAAC,OAAIH,UAAW,eAAoB,WAClC,UAAC,OACCA,UAAW,WAAgB,CAC3BI,IAAKjB,EAASe,KAAK,CACnBG,IAAK,EAAAC,cAAc,CAACnB,EAASe,KAAK,CAAC,GAErC,WAAC,OAAIF,UAAW,wBAA6B,WAC3C,UAAC,OACCA,UAAW,oBAAyB,CACpCI,IAAKjB,EAASgB,SAAS,CACvBE,IAAK,EAAAE,gBAAgB,CAACpB,EAASgB,SAAS,CAAC,GAE1ChB,EAASqB,mBAAmB,CAC3B,UAAC,OACCR,UAAW,qBAA0B,CACrCI,IAAKjB,EAASqB,mBAAmB,CACjCH,IAAK,EAAAE,gBAAgB,CAACpB,EAASqB,mBAAmB,CAAC,GAEnD,WAGN,KACJ,WAAC,OAAIR,UAAW,eAAoB,WAClC,UAAC,OAAIS,MAAOtB,MAAAA,EAAA,OAAAA,EAAUK,aAAa,UAChCL,MAAAA,EAAA,OAAAA,EAAUuB,gBAAgB,GAG5B,AAAAvB,CAAAA,MAAAA,EAAA,OAAAA,EAAUwB,MAAM,AAAD,EACd,UAAC,EAAAC,cAAc,EACbC,MAAO,CACLC,WAAY,CACVC,KAAM,CACJC,OAAQ,QACRC,SAAU,EACZ,CACF,CACF,WAEA,UAAC,EAAAF,IAAI,EACHf,UAAW,cAAmB,CAC9BkB,MAAOpC,EACPqC,MAAO,EAAAC,YAAY,CAACjC,EAASwB,MAAM,CAAC,CACpCU,SAAU,AAAAC,IACRvC,MAAAA,GAAAA,EAAuBuC,EACzB,MAGF,UAIZ,+JC1FK,IAAMC,EAET,AAAC,QAAE1C,KAAAA,CAAI,CAAE,GAAG2C,EAAM,GACd,CAAC1C,EAAc2C,EAAgB,CAAG,KAAAC,QAAA,EAAS,GACjD,MACE,UAAC,EAAAC,SAAS,EACP,GAAGH,CAAI,CACRN,MAAO,CAAErC,KAAAA,EAAMC,aAAAA,CAAa,EAC5Be,MAAO,CACL+B,MAAO,IACPC,OAAQ,IACRC,UAAW,aACXC,SAAU,QACZ,EACAC,MACE,UAAC,EAAApD,eAAe,EACdC,KAAMA,EACNC,aAAcA,EACdC,qBAAsB0C,KAKhC,iOCjBO,IAAMQ,EAA4B,KACvC,IAAMC,EAAU,KAAA5C,MAAA,IACV,CAAC,CAAEN,aAAAA,CAAY,CAAE,CAAC,CAAG,KAAAC,QAAA,EAAS,EAAAC,cAAc,EAE5CiD,EAAS,KAAA/C,OAAA,EAAQ,IACd,KAAAgD,OAAA,EAAQC,OAAOC,MAAM,CAACtD,GAAe,AAAAuD,GAAQA,EAAKpC,SAAS,EACjE,CAACnB,EAAa,EAGjB,OADAwD,QAAQC,GAAG,CAAC,SAAUN,GAEpB,WAAC,EAAAO,SAAS,EAACR,QAASA,YAClB,UAAC,EAAAQ,SAAA,SAAkB,EAACjC,MAAM,yCACxB,UAAC,EAAAkC,WAAW,EACV9D,KAAK,QACL+D,MAAM,mBACNC,YAAY,8DACZC,MAAO,CAAC,CAAEC,SAAU,EAAK,EAAE,KAG/B,UAAC,EAAAL,SAAA,SAAkB,EACjBjC,MAAM,6CACNuC,eAAgB,AAAAC,IACdT,QAAQC,GAAG,CAAC,UAAWQ,EACzB,WAEA,UAAC,EAAAC,IAAA,KAAS,EAACrE,KAAM,gBACf,UAAC,EAAA8C,SAAA,MAAe,EAACwB,SAAQ,YACtBhB,CAAM,CAAC,EAAAiB,qBAAA,KAA0B,CAAC,CAACC,GAAG,CAAC,AAAAlE,GACtC,UAAC,EAAAoC,2BAA2B,EAE1B1C,KAAMM,EAASK,aAAa,EADvBL,EAASK,aAAa,WAS3C,8HCzCA,EARkC,IAE9B,UAAC,EAAA8D,aAAa,EAAC7C,MAAM,8CACnB,UAAC,EAAAwB,eAAe"}