{"version":3,"file":"static/js/async/409.f7c90647.js","sources":["./src/components/AdaptiveAurorianCard/components/asc/index.tsx","./src/components/AdaptiveAurorianCard/index.tsx","./src/components/RelativeTimeText/index.tsx","./src/components/SolutionCard/CopilotBlock/AdaptiveAuroriansTeam/index.tsx","./src/components/SolutionCard/CopilotBlock/index.tsx","./src/components/TermChanger.tsx","./src/components/TermNotFound.tsx","./src/components/AdaptiveAurorianCard/hooks/use-lazy-image.ts","./src/components/SolutionCard/CopilotBlock/constants.ts","./src/components/utils.ts","./src/services/solution-algorithm.ts","./src/views/SolutionView/QueryForm/utils.ts","./src/views/SolutionView/context.ts","./src/views/SolutionView/hooks/use-request-solution.ts","./src/views/SolutionView/hooks/use-trigger-form-action/constants.ts","./src/views/SolutionView/hooks/use-trigger-form-action/index.ts","./src/views/SolutionView/utils/without-exclude.ts"],"sourcesContent":["import clsx from 'clsx';\nimport React from 'react';\nimport styles from './styles.module.less';\n\ninterface AscProps {\n  rairty: number;\n  asc: number;\n}\n\nexport const IconAsc = React.memo<AscProps>(\n  ({ rairty }) => {\n    return (\n      <div\n        className={clsx(\n          styles.Asc,\n          rairty >= 4 ? styles.Icon3of3 : styles.Icon2of2,\n        )}\n      ></div>\n    );\n  },\n  (a, b) => a.asc === b.asc && a.rairty === b.rairty,\n);\n","/* eslint-disable no-nested-ternary */\nimport React, { useMemo } from 'react';\nimport { useModel } from '@modern-js/runtime/model';\nimport type {\n  AurorianRequirementRemarkType,\n  AurorianNextType,\n} from '@sinsa/schema';\nimport clsx from 'clsx';\nimport type { MenuProps } from 'antd';\nimport { ConfigProvider, Flex, Rate, Tag, Dropdown } from 'antd';\nimport { useBreakpoint } from '@ant-design/pro-components';\nimport { m } from 'framer-motion';\nimport styles from './styles.module.less';\nimport { useLazyImage } from './hooks/use-lazy-image';\nimport {\n  AdaptiveAurorianCardMenuKey,\n  ClassURLMapper,\n  ElementURLMapper,\n} from './constants';\nimport { IconAsc } from './components/asc';\nimport { AuroriansModel } from '@/models/aurorians';\nimport { useSolutionResultContext } from '@/views/SolutionView/context';\nimport { QueryFormAction } from '@/views/SolutionView/hooks/use-trigger-form-action/constants';\n\ninterface AdaptiveArurorianCardProps {\n  aurorianId: string;\n  breakthrough?: number;\n  remark?: AurorianRequirementRemarkType;\n  readOnly?: boolean;\n  mini?: boolean;\n}\n\nexport const AdaptiveAurorianCard = React.memo<AdaptiveArurorianCardProps>(\n  ({ aurorianId: name, breakthrough, remark, readOnly, mini }) => {\n    const [{ auroriansMap }] = useModel(AuroriansModel);\n    const aurorian = useMemo(\n      () => auroriansMap[name] as AurorianNextType | undefined,\n      [auroriansMap, name],\n    );\n    const { containerRef } = useLazyImage(aurorian?.aurorian_id);\n\n    const screen = useBreakpoint();\n    const rateTheme = useMemo(() => {\n      let starSize = 10;\n      switch (screen) {\n        case 'xs':\n          starSize = 10;\n          break;\n        case 'sm':\n          starSize = 12;\n          break;\n        default:\n          starSize = 13;\n          break;\n      }\n      return {\n        components: {\n          Rate: {\n            starBg: 'white',\n            starSize,\n          },\n        },\n      };\n    }, [screen]);\n\n    const items: MenuProps['items'] = useMemo(\n      () =>\n        [\n          {\n            label: `排除${aurorian?.cn_name}`,\n            key: AdaptiveAurorianCardMenuKey.IgnoreAurorian,\n          },\n          typeof breakthrough === 'number'\n            ? {\n                label: `仅排除此突破数的${aurorian?.cn_name}`,\n                key: AdaptiveAurorianCardMenuKey.IgnoreBreakthrough,\n              }\n            : null,\n          {\n            label: `替换${aurorian?.cn_name}`,\n            key: AdaptiveAurorianCardMenuKey.ReplaceAurorian,\n          },\n        ].filter(_ => _),\n      [aurorian?.cn_name, breakthrough],\n    );\n\n    const { triggerFormAction } = useSolutionResultContext();\n\n    return (\n      <Dropdown\n        disabled={readOnly}\n        trigger={['click']}\n        getPopupContainer={() => document.body}\n        menu={{\n          items,\n          onClick: ({ key }) => {\n            if (!aurorian?.aurorian_id) {\n              return;\n            }\n\n            switch (key) {\n              case AdaptiveAurorianCardMenuKey.IgnoreBreakthrough:\n                if (typeof breakthrough === 'number') {\n                  triggerFormAction({\n                    type: QueryFormAction.IgnoreAurorianBreakthroughOnly,\n                    aurorian,\n                    breakthrough,\n                  });\n                }\n\n                break;\n              case AdaptiveAurorianCardMenuKey.IgnoreAurorian:\n                triggerFormAction({\n                  type: QueryFormAction.IgnoreAurorian,\n                  aurorian,\n                });\n                break;\n              default:\n                break;\n            }\n          },\n        }}\n      >\n        <m.div\n          ref={containerRef}\n          className={clsx(\n            styles.AdaptiveAurorianCard,\n            styles.BackgroundImage,\n            readOnly && styles.Disabled,\n            mini ? styles.MiniSize : styles.LargeSize,\n          )}\n          whileHover={readOnly ? undefined : { opacity: 0.6 }}\n          whileTap={readOnly ? undefined : { opacity: 0.2 }}\n        >\n          {aurorian ? (\n            <>\n              <Flex vertical className={styles.NameContainer}>\n                <span>{aurorian?.cn_name}</span>\n                {typeof breakthrough === 'number' && aurorian?.rarity ? (\n                  <ConfigProvider theme={rateTheme}>\n                    <Rate\n                      className={styles.BreakThrough}\n                      disabled\n                      value={breakthrough}\n                      count={aurorian.rarity}\n                    />\n                  </ConfigProvider>\n                ) : null}\n              </Flex>\n              <Flex align=\"center\" className={styles.MetaContainer}>\n                <img\n                  className={styles.MetaClass}\n                  alt={aurorian.profession}\n                  src={ClassURLMapper[aurorian.profession]}\n                />\n                <Flex align=\"center\" vertical={mini}>\n                  <img\n                    className={styles.MetaFirstAttribute}\n                    alt={aurorian.primary_element}\n                    src={ElementURLMapper[aurorian.primary_element]}\n                  />\n                  {aurorian.secondary_element ? (\n                    <img\n                      className={styles.MetaSecondAttribute}\n                      alt={aurorian.secondary_element}\n                      src={ElementURLMapper[aurorian.secondary_element]}\n                    />\n                  ) : null}\n                </Flex>\n              </Flex>\n            </>\n          ) : null}\n          {remark?.replace?.type === 'any' && remark?.replace?.any === 'All' ? (\n            <Tag className={styles.ReplaceableTag} color={'#dc5950'}>\n              可替\n            </Tag>\n          ) : null}\n          {remark?.replace?.type === 'any' && remark?.replace?.any === 'DPS' ? (\n            <Tag className={styles.ReplaceableTag} color={'#dc5950'}>\n              可替输出\n            </Tag>\n          ) : null}\n          {remark?.replace?.type === 'any' ? null : aurorian?.rarity &&\n            remark?.level?.asc === 3 &&\n            typeof remark?.level?.lv === 'number' ? (\n            <Tag className={styles.RemarkContainer} color={'rgba(0,0,0,0.4)'}>\n              <Flex align=\"center\" gap={2}>\n                <IconAsc rairty={aurorian.rarity} asc={3} />\n                <span className={styles.num}>{remark?.level?.lv}</span>\n              </Flex>\n            </Tag>\n          ) : null}\n        </m.div>\n      </Dropdown>\n    );\n  },\n);\n","import { Tooltip } from 'antd';\nimport dayjs from 'dayjs';\nimport React from 'react';\nimport styles from './styles.module.less';\n\ninterface RelativeTimeTextProps {\n  time: Date;\n}\n\nexport const RelativeTimeText = React.memo<RelativeTimeTextProps>(\n  ({ time }) => {\n    return (\n      <Tooltip title={dayjs(time).format('YYYY-MM-DD HH:mm:ss')}>\n        <span className={styles.RelativeTimeText}>{dayjs(time).fromNow()}</span>\n      </Tooltip>\n    );\n  },\n  (prev, cur) => prev.time.valueOf() === cur.time.valueOf(),\n);\n","import type React from 'react';\nimport { Flex } from 'antd';\nimport type { CopilotNextType } from '@sinsa/schema';\nimport styles from './styles.module.less';\nimport { AdaptiveAurorianCard } from '@/components/AdaptiveAurorianCard';\n\ninterface AdaptiveAuroriansTeamProps {\n  aurorianRequirements: CopilotNextType['aurorian_requirements'];\n  readOnly?: boolean;\n}\n\nexport const AdaptiveAuroriansTeam: React.FC<AdaptiveAuroriansTeamProps> = ({\n  aurorianRequirements,\n  readOnly,\n}) => {\n  return (\n    <Flex className={styles.AuroriansTeam}>\n      {aurorianRequirements.map(({ aurorian_id, breakthrough, remark }) => {\n        return (\n          <AdaptiveAurorianCard\n            key={aurorian_id}\n            aurorianId={aurorian_id}\n            breakthrough={breakthrough}\n            remark={remark}\n            readOnly={readOnly}\n          />\n        );\n      })}\n    </Flex>\n  );\n};\n","import { clsx } from 'clsx';\nimport {\n  Button,\n  Dropdown,\n  Flex,\n  Popconfirm,\n  Space,\n  Tag,\n  Tooltip,\n  Typography,\n} from 'antd';\nimport React, { useMemo } from 'react';\nimport numeral from 'numeral';\nimport { useBreakpoint } from '@ant-design/pro-components';\nimport {\n  MessageOne,\n  More,\n  Paperclip,\n  PreviewCloseOne,\n  Bug,\n} from '@icon-park/react';\nimport type { CopilotNextType, TermNextType } from '@sinsa/schema';\nimport { AdaptiveAuroriansTeam } from './AdaptiveAuroriansTeam';\nimport styles from './styles.module.less';\nimport { AssetTypeTextMapper } from './constants';\nimport { RelativeTimeText } from '@/components/RelativeTimeText';\nimport { trimTitle } from '@/components/utils';\nimport { useSolutionResultContext } from '@/views/SolutionView/context';\nimport { QueryFormAction } from '@/views/SolutionView/hooks/use-trigger-form-action/constants';\n\ninterface CopilotBlockProps {\n  copilot: CopilotNextType;\n  currentTerm: TermNextType;\n  className?: string;\n\n  readOnly?: boolean;\n}\n\nenum MenuKey {\n  IgnoreCopilot = 'IgnoreCopilot',\n}\n\nexport const CopilotBlock = React.memo<CopilotBlockProps>(\n  ({ copilot, currentTerm, className, readOnly }) => {\n    const screen = useBreakpoint();\n    const isLarge = useMemo(\n      () => screen === 'lg' || screen === 'xl' || screen === 'xxl',\n      [screen],\n    );\n    const hasAsset = useMemo(() => {\n      return Array.isArray(copilot.assets);\n    }, [copilot.assets]);\n\n    const displayTitle = useMemo(\n      () => trimTitle(copilot.title),\n      [copilot.title],\n    );\n\n    const { triggerFormAction } = useSolutionResultContext();\n\n    function handleClickMenu(info: { key: string }) {\n      switch (info.key) {\n        case MenuKey.IgnoreCopilot:\n          triggerFormAction({\n            type: QueryFormAction.IgnoreCopilot,\n            copilot,\n          });\n          break;\n        default:\n          break;\n      }\n    }\n    return (\n      <div className={clsx(styles.CopilotBlock, className)}>\n        <AdaptiveAuroriansTeam\n          aurorianRequirements={copilot.aurorian_requirements}\n          readOnly={readOnly}\n        />\n        <div className={styles.PaddingContainer}>\n          <Flex className={styles.Header}>\n            <span className={styles.Score}>\n              {numeral(copilot.score).format('0,0')}\n            </span>\n            <Flex className={styles.Author} align=\"center\" gap={6}>\n              <Typography.Text strong>{copilot.author_name}</Typography.Text>\n\n              {copilot.description && !isLarge ? (\n                <Tooltip title={copilot.description}>\n                  {copilot.description ? <MessageOne size={18} /> : null}\n                </Tooltip>\n              ) : null}\n\n              <RelativeTimeText time={copilot.upload_time} />\n\n              <Space.Compact size=\"small\">\n                {!readOnly ? (\n                  <Dropdown\n                    menu={{\n                      items: [\n                        {\n                          key: MenuKey.IgnoreCopilot,\n                          label: (\n                            <span>\n                              <PreviewCloseOne /> 排除此作业\n                            </span>\n                          ),\n                        },\n                      ],\n                      onClick: handleClickMenu,\n                    }}\n                  >\n                    <Button icon={<More />} />\n                  </Dropdown>\n                ) : null}\n\n                <Button\n                  icon={\n                    <Tooltip title=\"报告收录错误\">\n                      <Bug />\n                    </Tooltip>\n                  }\n                  onClick={e => {\n                    e.stopPropagation();\n                    const params = {\n                      有收录问题的作业所在荒典期数: copilot.term_id,\n                      有收录问题的作业视频链接: `${copilot.author_name} ${copilot.title} https://www.bilibili.com/video/${copilot.href}`,\n                    };\n\n                    const queryString = Object.entries(params)\n                      .map(\n                        ([key, value]) =>\n                          `prefill_${window.encodeURIComponent(\n                            key,\n                          )}=${window.encodeURIComponent(value)}`,\n                      )\n                      .join('&');\n                    window.open(\n                      `https://fwf92qm5h53.feishu.cn/share/base/form/shrcnFMYfIOulCFwcl5ELDfGCVf?${queryString}`,\n                      '_blank',\n                    );\n                  }}\n                />\n              </Space.Compact>\n            </Flex>\n          </Flex>\n          <div className={styles.Title}>\n            <Typography.Link\n              href={`https://www.bilibili.com/video/${copilot.href}`}\n              target=\"_blank\"\n              title={copilot.title}\n              ellipsis={true}\n            >\n              {currentTerm?.term_id &&\n              copilot.term_id !== currentTerm.term_id ? (\n                <Tooltip title={`复刻 ${copilot.term_id} 期荒典`}>\n                  <Tag color=\"red\">复刻</Tag>\n                </Tooltip>\n              ) : null}\n              {displayTitle}\n            </Typography.Link>\n          </div>\n          {copilot.description && isLarge ? (\n            <Typography.Paragraph type=\"secondary\">\n              {copilot.description}\n            </Typography.Paragraph>\n          ) : null}\n          {hasAsset && isLarge\n            ? copilot.assets?.map((asset, index) => (\n                <Popconfirm\n                  // eslint-disable-next-line react/no-array-index-key\n                  key={`${asset.type}${index}`}\n                  okText=\"确认\"\n                  title=\"此资源仅为临时存档。是否开始下载？\"\n                  onConfirm={() => {\n                    const el = document.createElement('a');\n                    el.href = asset.script33.link;\n                    el.click();\n                  }}\n                >\n                  <Typography.Link>\n                    <Paperclip /> {AssetTypeTextMapper[asset.type]}\n                    存档\n                  </Typography.Link>\n                </Popconfirm>\n              ))\n            : null}\n        </div>\n      </div>\n    );\n  },\n  (prev, next) =>\n    prev.className === next.className &&\n    prev.copilot.copilot_id === next.copilot.copilot_id &&\n    prev.currentTerm.term_id === next.currentTerm.term_id,\n);\n","import { useModel } from '@modern-js/runtime/model';\nimport { Select } from 'antd';\nimport { useNavigate, useParams } from '@modern-js/runtime/router';\nimport { useMemo } from 'react';\nimport { TermsModel } from '@/models/terms';\nimport type { RoutePath } from '@/views/GlobalLayout/constants';\n\nexport function useTargetTermFromParams() {\n  const params = useParams<{ termId: string | 'latest' }>();\n  const [{ termsMap, latestTerm }] = useModel(TermsModel);\n\n  const targetTerm = useMemo(() => {\n    if (!params.termId) {\n      return undefined;\n    }\n    return params.termId === 'latest' ? latestTerm : termsMap[params.termId];\n  }, [params.termId, latestTerm?.term_id]);\n\n  return {\n    targetTerm,\n  };\n}\n\nexport const TermChanger: React.FC<{\n  pathFn: typeof RoutePath.Copilots | typeof RoutePath.Solutions;\n}> = ({ pathFn }) => {\n  const [terms] = useModel(TermsModel);\n  const { targetTerm } = useTargetTermFromParams();\n  const navigate = useNavigate();\n\n  return (\n    <Select\n      value={targetTerm?.term_id}\n      options={terms.termsOptions}\n      placeholder=\"荒典期数\"\n      onChange={nextTerm => {\n        navigate(\n          pathFn(nextTerm === terms.latestTerm?.term_id ? 'latest' : nextTerm),\n        );\n      }}\n    />\n  );\n};\n","import { useModel } from '@modern-js/runtime/model';\nimport { Button, Result } from 'antd';\nimport { Link } from '@modern-js/runtime/router';\nimport { TermsModel } from '@/models/terms';\nimport { RoutePath } from '@/views/GlobalLayout/constants';\nimport SINSA_SORRY_URL from '@/assets/sinsa/sorry.png';\n\nexport const TermNotFound: React.FC = () => {\n  const [{ latestTerm }] = useModel(TermsModel);\n\n  return (\n    <Result\n      title=\"暂时没有这期荒典作业\"\n      subTitle=\"检查链接是否正确或返回最近荒典作业\"\n      icon={<img alt=\"未找到作业\" src={SINSA_SORRY_URL} />}\n      extra={\n        latestTerm ? (\n          <Link to={RoutePath.Copilots('latest')}>\n            <Button type=\"primary\">返回最近作业</Button>\n          </Link>\n        ) : (\n          <Link to={RoutePath.Home}>\n            <Button type=\"primary\">返回首页</Button>\n          </Link>\n        )\n      }\n    />\n  );\n};\n","import { useEffect, useRef } from 'react';\n\nexport function useLazyImage(aurorianId?: string) {\n  const containerRef = useRef<HTMLDivElement>(null);\n  useEffect(() => {\n    const loadImage = async () => {\n      if (aurorianId && containerRef.current) {\n        containerRef.current.style.backgroundImage = `url(/assets/images/avatars/${aurorianId}.webp)`;\n      }\n    };\n    loadImage();\n  }, [aurorianId]);\n\n  return {\n    containerRef,\n  };\n}\n","import type { CopilotNextAssetType } from '@sinsa/schema';\n\nexport const AssetTypeTextMapper: Record<CopilotNextAssetType['type'], string> =\n  {\n    script33: '三十三号脚本',\n  };\n","export function trimTitle(title: string): string {\n  return title\n    .replace('[白夜极光]', '')\n    .replace('【白夜极光】', '')\n    .replace('白夜极光', '')\n    .replace('荒典', '')\n    .replace('[hidden]', '');\n}\n","import type {\n  CalcOptions,\n  SolutionContext,\n  AllSolutions,\n} from '@sinsa/solution-calculator/dist/types/types';\n\nexport class SolutionAlgorithmService {\n  private static instance: SolutionAlgorithmService | null = null;\n\n  public static getInstance(): SolutionAlgorithmService {\n    if (SolutionAlgorithmService.instance === null) {\n      SolutionAlgorithmService.instance = new SolutionAlgorithmService();\n    }\n    return SolutionAlgorithmService.instance;\n  }\n\n  protected constructor() {\n    // noop\n  }\n\n  calculateAllSolutions(\n    context: SolutionContext,\n    k: number,\n    options: CalcOptions,\n  ): Promise<AllSolutions> {\n    return new Promise((resolve, reject) => {\n      const worker = new Worker(\n        new URL('@sinsa/solution-calculator', import.meta.url),\n      );\n\n      worker.addEventListener('message', event => {\n        const result = event.data;\n        resolve(result);\n        worker.terminate();\n      });\n\n      worker.addEventListener('error', error => {\n        reject(error);\n        worker.terminate();\n      });\n\n      worker.postMessage({ context, k, options });\n    });\n  }\n}\n\nexport const solutionAlgorithm = SolutionAlgorithmService.getInstance();\n","import type { QueryParamsType } from '../schemas/query-params';\n\nexport function ensureQueryKey(key: keyof QueryParamsType) {\n  return key;\n}\n","import constate from 'constate';\nimport { ProForm } from '@ant-design/pro-components';\nimport { useRequestSolution } from './hooks/use-request-solution';\nimport type { QueryParamsType } from './schemas/query-params';\nimport { useTriggerFormAction } from './hooks/use-trigger-form-action';\n\nexport const [SolutionResultProvider, useSolutionResultContext] = constate(\n  () => {\n    const { solutionResult, loadingSolutionResult, requestSolution } =\n      useRequestSolution();\n\n    const [form] = ProForm.useForm<QueryParamsType>();\n\n    const { triggerFormAction } = useTriggerFormAction(form);\n\n    return {\n      solutionResult,\n      loadingSolutionResult,\n      requestSolution,\n      form,\n      triggerFormAction,\n    };\n  },\n);\n","import { useRequest } from 'ahooks';\nimport { useModel } from '@modern-js/runtime/model';\nimport type { Solution } from '@sinsa/solution-calculator/dist/types/types';\nimport type { CopilotNextType } from '@sinsa/schema';\nimport type { QueryParamsType } from '../schemas/query-params';\nimport { withoutExclude } from '../utils/without-exclude';\nimport { AuroriansModel } from '@/models/aurorians';\nimport { solutionAlgorithm } from '@/services/solution-algorithm';\n\nexport function useRequestSolution() {\n  const [{ WHOLE_BOX }] = useModel(AuroriansModel);\n  const {\n    data: solutionResult,\n    loading: loadingSolutionResult,\n    runAsync: requestSolution,\n  } = useRequest(\n    async (\n      copilots: CopilotNextType[],\n      {\n        exclude,\n        k,\n        disableAlternative,\n        copilotsIgnore,\n        enableExclude,\n      }: QueryParamsType,\n    ) => {\n      const availableBox =\n        enableExclude && Array.isArray(exclude)\n          ? withoutExclude(WHOLE_BOX, exclude)\n          : WHOLE_BOX;\n\n      const allSolutions = await solutionAlgorithm.calculateAllSolutions(\n        {\n          copilots,\n          availableBox,\n        },\n        k,\n        { disableAlternative, copilotsIgnore },\n      );\n\n      const rankSet = new WeakMap<Solution, number>();\n      for (let i = 0; i < allSolutions.solutions.length; i++) {\n        const target = allSolutions.solutions[i];\n        rankSet.set(target, i);\n      }\n\n      return {\n        allSolutions,\n        rankSet,\n      };\n    },\n    {\n      manual: true,\n    },\n  );\n\n  return {\n    solutionResult,\n    loadingSolutionResult,\n    requestSolution,\n  };\n}\n","export enum QueryFormAction {\n  IgnoreAurorian = 'IgnoreAurorian',\n  IgnoreAurorianBreakthroughOnly = 'IgnoreAurorianBreakthroughOnly',\n  IgnoreCopilot = 'IgnoreCopilot',\n  ReplaceAurorian = 'ReplaceAurorian',\n}\n","import type { ProFormInstance } from '@ant-design/pro-components';\nimport { useCallback } from 'react';\nimport type { AurorianNextType, CopilotNextType } from '@sinsa/schema';\nimport type {\n  ExcludeDataType,\n  QueryParamsType,\n} from '../../schemas/query-params';\nimport { ensureQueryKey } from '../../QueryForm/utils';\nimport { getNormalizeBreakthroughByRarity } from '../../utils/without-exclude';\nimport { QueryFormAction } from './constants';\n\nexport type TriggerFormActionPayload =\n  | {\n      type: QueryFormAction.IgnoreAurorian;\n      aurorian: AurorianNextType;\n    }\n  | {\n      type: QueryFormAction.IgnoreAurorianBreakthroughOnly;\n      aurorian: AurorianNextType;\n      breakthrough: number;\n    }\n  | {\n      type: QueryFormAction.IgnoreCopilot;\n      copilot: CopilotNextType;\n    }\n  | {\n      type: QueryFormAction.ReplaceAurorian;\n      aurorian: AurorianNextType;\n      copilot: CopilotNextType;\n    };\n\nexport function useTriggerFormAction(form: ProFormInstance<QueryParamsType>) {\n  const triggerFormAction = useCallback(\n    (payload: TriggerFormActionPayload) => {\n      switch (payload.type) {\n        // 1. 排除单个作业\n        case QueryFormAction.IgnoreCopilot: {\n          const copilotsIgnore = form.getFieldValue(\n            ensureQueryKey('copilotsIgnore'),\n          );\n          const newCopilotsIgnore = Array.isArray(copilotsIgnore)\n            ? [...copilotsIgnore, payload.copilot.copilot_id]\n            : [payload.copilot.copilot_id];\n          form.setFieldValue(\n            ensureQueryKey('copilotsIgnore'),\n            newCopilotsIgnore,\n          );\n          break;\n        }\n\n        // 2. 排除单个光灵\n        case QueryFormAction.IgnoreAurorian:\n        case QueryFormAction.IgnoreAurorianBreakthroughOnly: {\n          form.setFieldValue(ensureQueryKey('enableExclude'), true);\n          const { exclude } = form.getFieldsValue();\n          // 光灵是否已经在排除列表里了\n          const existAurorianInfo = exclude?.find(\n            ex => ex.aurorianId === payload.aurorian.aurorian_id,\n          );\n          let clonedExclude = Array.isArray(exclude) ? Array.from(exclude) : [];\n          if (existAurorianInfo) {\n            clonedExclude = clonedExclude.filter(\n              info => info.aurorianId !== existAurorianInfo.aurorianId,\n            );\n          }\n          const newExclude: ExcludeDataType[] =\n            payload.type === QueryFormAction.IgnoreAurorianBreakthroughOnly\n              ? [\n                  ...clonedExclude,\n                  {\n                    aurorianId: payload.aurorian.aurorian_id,\n                    excludeBreakthroughOnly: true,\n                    excludeBreakthrough: getNormalizeBreakthroughByRarity(\n                      payload.breakthrough,\n                      payload.aurorian.rarity,\n                    ),\n                  },\n                ]\n              : [\n                  ...clonedExclude,\n                  { aurorianId: payload.aurorian.aurorian_id },\n                ];\n          form.setFieldValue(ensureQueryKey('exclude'), newExclude);\n\n          break;\n        }\n\n        default:\n          break;\n      }\n      window.setTimeout(() => form.submit());\n    },\n    [form],\n  );\n\n  return {\n    triggerFormAction,\n  };\n}\n","import { produce } from 'immer';\nimport type { AurorianRequirementType } from '@sinsa/schema';\nimport type { QueryParamsType } from '../schemas/query-params';\n\nexport function getNormalizeBreakthroughByRarity(\n  currentBreakthrough: number,\n  rarity: 1 | 2 | 3 | 4 | 5 | 6 | number,\n) {\n  switch (rarity) {\n    case 6:\n      return [0, 0, 3, 3, 3, 6].at(currentBreakthrough - 1)!;\n    case 5:\n      return [0, 2, 2, 2, 5].at(currentBreakthrough - 1)!;\n    case 4:\n      return [0, 0, 0, 4].at(currentBreakthrough - 1)!;\n    case 3:\n      return [0, 0, 3].at(currentBreakthrough - 1)!;\n    case 2:\n      return [0, 2].at(currentBreakthrough - 1)!;\n    case 1:\n      return [1].at(currentBreakthrough - 1)!;\n    default:\n      return 0;\n  }\n}\n\nexport function withoutExclude(\n  summaries: Record<\n    AurorianRequirementType['aurorian_id'],\n    AurorianRequirementType\n  >,\n  exclude: QueryParamsType['exclude'],\n) {\n  if (!exclude) {\n    return summaries;\n  }\n  return produce(summaries, draft => {\n    for (const {\n      excludeBreakthroughOnly,\n      excludeBreakthrough,\n      aurorianId,\n    } of exclude) {\n      // 如果是仅仅排除突破\n      if (excludeBreakthroughOnly) {\n        // 如果排除突破的要求 >= 1\n        if (\n          typeof excludeBreakthrough === 'number' &&\n          excludeBreakthrough >= 1\n        ) {\n          // const targetAurorian = auroriansMap[aurorianName];\n          // 那么说明 Box 里的该光灵的突破一定比排除突破小 1\n          draft[aurorianId].breakthrough = Math.max(excludeBreakthrough - 1, 0);\n        }\n      } else {\n        // 否则排除该光灵\n        delete draft[aurorianId];\n      }\n    }\n  });\n}\n"],"names":["IconAsc","rairty","className","a","b","asc","AdaptiveAurorianCard","aurorianId","name","breakthrough","remark","readOnly","mini","auroriansMap","useModel","AuroriansModel","aurorian","useMemo","containerRef","useLazyImage","aurorian_id","screen","useBreakpoint","rateTheme","starSize","components","Rate","starBg","items","label","cn_name","key","AdaptiveAurorianCardMenuKey","filter","_","triggerFormAction","useSolutionResultContext","Dropdown","disabled","trigger","getPopupContainer","document","body","menu","onClick","type","QueryFormAction","m","ref","whileHover","undefined","opacity","whileTap","Flex","vertical","rarity","ConfigProvider","theme","value","count","align","alt","profession","src","ClassURLMapper","primary_element","ElementURLMapper","secondary_element","replace","any","Tag","color","level","lv","gap","RelativeTimeText","time","Tooltip","title","format","fromNow","prev","cur","valueOf","AdaptiveAuroriansTeam","aurorianRequirements","map","MenuKey","CopilotBlock","copilot","currentTerm","isLarge","hasAsset","Array","isArray","assets","displayTitle","trimTitle","clsx","aurorian_requirements","score","Typography","strong","author_name","description","MessageOne","size","upload_time","Space","PreviewCloseOne","info","Button","icon","More","Bug","e","stopPropagation","queryString","Object","entries","term_id","href","window","encodeURIComponent","join","open","target","ellipsis","asset","index","Popconfirm","okText","onConfirm","el","createElement","script33","link","click","Paperclip","AssetTypeTextMapper","next","copilot_id","useTargetTermFromParams","params","useParams","termsMap","latestTerm","TermsModel","targetTerm","termId","TermChanger","pathFn","terms","navigate","useNavigate","Select","options","termsOptions","placeholder","onChange","nextTerm","TermNotFound","Result","subTitle","extra","Link","to","RoutePath","useRef","useEffect","loadImage","current","style","backgroundImage","SolutionAlgorithmService","getInstance","instance","calculateAllSolutions","context","k","Promise","resolve","reject","worker","Worker","URL","addEventListener","event","data","terminate","error","postMessage","solutionAlgorithm","ensureQueryKey","SolutionResultProvider","solutionResult","loadingSolutionResult","requestSolution","useRequestSolution","form","ProForm","useTriggerFormAction","WHOLE_BOX","loading","runAsync","useRequest","copilots","exclude","disableAlternative","copilotsIgnore","enableExclude","availableBox","withoutExclude","allSolutions","rankSet","WeakMap","i","solutions","length","set","manual","useCallback","payload","getFieldValue","newCopilotsIgnore","setFieldValue","getFieldsValue","existAurorianInfo","find","ex","clonedExclude","from","newExclude","excludeBreakthroughOnly","excludeBreakthrough","getNormalizeBreakthroughByRarity","setTimeout","submit","currentBreakthrough","at","summaries","produce","draft","Math","max"],"mappings":"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"}