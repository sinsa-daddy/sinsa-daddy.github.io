"use strict";(globalThis.webpackChunk_sinsa_web=globalThis.webpackChunk_sinsa_web||[]).push([[2370],{23930:(e,r,a)=>{a.r(r),a.d(r,{default:()=>R});var o=a(19279),n=a(16799),t=a(87363),l=a(76470),s=a(64762),i=a(76473),u=a(32479),c=a(10389),d=a(48636),h=a(92921),m=a(81821),x=a(13065),b=a(55950),p=a.n(b),g=a(82547);function j(e,r,{disalbeAlternative:a}){return(0,g.Uy)(e,(e=>{for(const o of r.aurorian_summaries)!a&&o.is_replaceable||delete e[o.aurorian_name]}))}function f(e,r,{disalbeAlternative:a}){for(const o of r.aurorian_summaries){if(!a&&o.is_replaceable)continue;const r=e[o.aurorian_name];if(!r)return!1;if(r.breakthrough<o.breakthrough)return!1}return!0}function B(e,r=3,{disalbeAlternative:a}={}){const o={scenarios:[]},n=[{currentCopilotIndex:0,currentScenario:[],remainingBox:e.availableBox,count:r}];for(;n.length>0;){const{currentCopilotIndex:t,currentScenario:l,remainingBox:s,count:i}=n.pop();if(0===i||t===e.copilots.length)l.length>=r&&o.scenarios.push({copilots:[...l],totalScore:l.reduce(((e,r)=>e+BigInt(r.score)),BigInt(0))});else{const r=e.copilots[t];if(f(s,r,{disalbeAlternative:a})){const e=j(s,r,{disalbeAlternative:a});n.push({currentCopilotIndex:t+1,currentScenario:[...l,r],remainingBox:e,count:i-1})}n.push({currentCopilotIndex:t+1,currentScenario:l,remainingBox:s,count:i})}}return o.scenarios.sort(((e,r)=>Number(r.totalScore-e.totalScore))),o}var y=a(38259),k=a(64419),w=a(23243),v=a(38706),S=a(97458);const Z=({solution:e,title:r})=>{const a=(0,t.useCallback)((async()=>({data:(0,g.Uy)(e.copilots,(e=>{e.sort(((e,r)=>Number(r.score-e.score)))})),success:!0})),[]),o=(0,t.useMemo)((()=>({title:r,settings:[]})),[r]),n=(0,t.useMemo)((()=>({x:"max-content"})),[]);return(0,S.jsx)(k.Z,{showHeader:!0,toolbar:o,rowKey:w.l,columns:v.B,request:a,search:!1,pagination:!1,scroll:n,ghost:!0})};var _=a(97822),A=a(46855),C=a(12781),T=a(67103),N=a(10927);const O=({name:e,...r})=>{const[{auroriansOptions:a,auroriansMap:o}]=(0,x.tT)(y.b);return(0,S.jsx)(_.u,{...r,creatorButtonProps:{creatorButtonText:"\u6dfb\u52a0\u6392\u9664\u7684\u5149\u7075"},name:e,alwaysShowItemLabel:!0,min:1,children:()=>(0,S.jsxs)(u.A.Group,{children:[(0,S.jsx)(A.Z,{label:"\u6392\u9664\u7684\u5149\u7075",name:"aurorianName",options:a,allowClear:!0,showSearch:!0,width:"sm",rules:[{required:!0}]}),(0,S.jsx)(h.Z,{name:["aurorianName"],children:({aurorianName:e})=>e?(0,S.jsx)(N.L,{sameSize:!0,name:e}):null},"excludeBreakthroughOnly"),(0,S.jsx)(h.Z,{name:["aurorianName"],children:({aurorianName:e})=>e?(0,S.jsx)(d.Z,{label:"\u4ec5\u6392\u9664\u7a81\u7834",name:"excludeBreakthroughOnly"}):null},"excludeBreakthroughOnly"),(0,S.jsx)(h.Z,{name:["aurorianName","excludeBreakthroughOnly"],children:({aurorianName:e,excludeBreakthroughOnly:r})=>{const a=o[e];return r&&a?(0,S.jsx)(C.Z,{name:"excludeBreakthrough",label:"\u6392\u9664\u7a81\u7834\u6570",fieldProps:{count:T.gW[a.rarity],allowHalf:!1},tooltip:"\u6b64\u7a81\u7834\u6570\u4ee5\u4e0a\u7684\u5149\u7075\u4f1a\u88ab\u6392\u9664\uff0c\u4f46\u4e0d\u4f1a\u6392\u9664\u96f6\u7834\u7684\u6b64\u5149\u7075"}):null}},"excludeBreakthrough")]})})},I={k:3,box:"whole",exclude:[{}]},P=({dataSource:e})=>{const[{WHOLE_BOX:r}]=(0,x.tT)(y.b),a=(0,t.useRef)(),{data:o,loading:n,runAsync:s}=(0,l.Z)((async a=>{let o=r.aurorian_summaries;a.exclude&&(o=(0,g.Uy)(r.aurorian_summaries,(e=>{for(const r of a.exclude)r.excludeBreakthroughOnly?"number"==typeof r.excludeBreakthrough&&r.excludeBreakthrough>=1&&(e[r.aurorianName].breakthrough=r.excludeBreakthrough-1):delete e[r.aurorianName]})));const[n]=await Promise.all([Promise.resolve(B({copilots:e,availableBox:o},a.k,{disalbeAlternative:a.disalbeAlternative})),new Promise((e=>window.setTimeout(e,100)))]),t=new WeakMap;for(let e=0;e<n.scenarios.length;e++){const r=n.scenarios[e];t.set(r,e)}return{solutionResult:n,rankSet:t}}),{manual:!0,defaultParams:[I]});return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(m.Card,{style:{marginBottom:"1rem"},children:(0,S.jsx)(u.A,{formRef:a,onFinish:async e=>{await s(e)},initialValues:I,layout:"vertical",submitter:{searchConfig:{submitText:"\u5bfb\u627e\u5339\u914d\u65b9\u6848"},render:(e,r)=>(0,S.jsxs)(m.Space,{wrap:!0,children:[r,o?.solutionResult?(0,S.jsxs)(m.Typography.Text,{children:["\u5df2\u4e3a\u60a8\u627e\u5230"," ",(0,S.jsx)(m.Typography.Text,{strong:!0,children:o?.solutionResult.scenarios.length})," ","\u4e2a\u5339\u914d\u65b9\u6848"]}):null]})},loading:n,children:(0,S.jsxs)(u.A.Group,{children:[(0,S.jsx)(c.Z.Group,{name:"k",label:"\u961f\u4f0d\u6570\u91cf",rules:[{required:!0}],options:[{label:"\u4e24\u652f\u961f\u4f0d",value:2},{label:"\u4e09\u652f\u961f\u4f0d",value:3},{label:"\u56db\u652f\u961f\u4f0d",value:4}],allowClear:!1,radioType:"button"}),(0,S.jsx)(c.Z.Group,{name:"box",label:"Box \u5339\u914d",options:[{label:"\u5168\u56fe\u9274\u6ee1\u7a81\u7834 Box",value:"whole"},{label:"\u6211\u7684\u81ea\u5b9a\u4e49 Box",value:"my-box",disabled:!0}],allowClear:!1,radioType:"button",rules:[{required:!0}],extra:"\u81ea\u5b9a\u4e49 Box \u5339\u914d\u6682\u4e0d\u652f\u6301\uff0c\u65e0\u6cd5\u9009\u4e2d\uff0c\u656c\u8bf7\u671f\u5f85w"}),(0,S.jsx)(d.Z,{name:"disalbeAlternative",label:"\u4e0d\u8003\u8651\u53ef\u66ff\u81ea\u7531\u4f4d",tooltip:"\u5f00\u542f\u540e\uff0c\u8ba1\u7b97\u7684\u961f\u4f0d\u65b9\u6848\u4e2d\u7edd\u5bf9\u4e0d\u4f1a\u51fa\u73b0\u91cd\u590d\u5149\u7075\uff0c\u6ee1\u8db3\u56fe\u9274\u5927\u4f6c\u7684\u5f3a\u8feb\u75c7"}),(0,S.jsxs)(u.A.Group,{children:[(0,S.jsx)(d.Z,{name:"enableExclude",label:"\u989d\u5916\u6392\u9664\u5149\u7075",tooltip:"\u6392\u9664\u5149\u7075\u4f1a\u5ffd\u7565\u53ef\u66ff\u81ea\u7531\u4f4d"}),(0,S.jsx)(h.Z,{name:["enableExclude"],children:({enableExclude:e})=>e?(0,S.jsx)(O,{name:"exclude"}):null})]})]})})}),(0,S.jsx)(m.List,{loading:n,dataSource:o?.solutionResult?.scenarios,pagination:{align:"center",defaultPageSize:5},rowKey:e=>e.copilots.map((e=>e.bv)).join(""),renderItem:e=>(0,S.jsx)(m.Card,{title:(0,S.jsxs)(S.Fragment,{children:[o?.rankSet?`#${(o.rankSet.get(e)??0)+1} \u5339\u914d\u65b9\u6848 `:null,p()(e.totalScore).format("0,0")]}),style:{marginBottom:"1rem"},children:(0,S.jsx)(Z,{solution:e})},e.copilots.map((e=>e.bv)).join(""))})]})};var M=a(29413);const R=()=>{const e=(0,o.UO)(),{data:r,error:a,loading:u}=(0,l.Z)((()=>fetch(`/api/copilots/${e.term}.json`).then((e=>e.json()))),{refreshDeps:[e.term]}),c=(0,t.useMemo)((()=>Object.values(r??[])),[r]);return a?(0,S.jsx)(s.n,{}):(0,S.jsx)(n._z,{content:(0,S.jsx)(i.M,{pathFn:M.h.Solutions}),title:"\u4f5c\u4e1a\u5339\u914d",loading:u,children:(0,S.jsx)(P,{dataSource:c})})}}}]);