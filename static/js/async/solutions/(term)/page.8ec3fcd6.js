"use strict";(globalThis.webpackChunk_sinsa_web=globalThis.webpackChunk_sinsa_web||[]).push([[2370],{10927:(e,r,a)=>{a.d(r,{L:()=>v});var t=a(87363),n=a.n(t),o=a(61093),s=a(81821),l=a(28934);const i="AurorianCard-Xue7wW",u="SameSize-ttH5Jw",c="MetaContainer-VBs_Be",d="SameSizeMeta-jxMufu",m="MetaAttributeContainer-oaQn6c",h="MetaClass-oogC_v",x="MetaFirstAttribute-bRrn32",p="MetaSecondAttribute-C0kSzr",b="NameContainer-zUDWby",g="BreakThrough-eMpTUR";var j=a(67103),f=a(38259),y=a(97458);const v=n().memo((({name:e,breakthrough:r,isReplaceable:n,sameSize:v})=>{const[{auroriansMap:S}]=(0,o.tT)(f.b),B=(0,t.useMemo)((()=>S[e]),[S,e]),w=(0,t.useRef)(null);return(0,t.useEffect)((()=>{B?.aurorian_name&&a(1798)(`./${B.aurorian_name}.webp`).then((e=>{"string"==typeof e?.default&&w.current&&(w.current.style.backgroundImage=`url(${e.default})`)})).catch((()=>{}))}),[B?.aurorian_name]),(0,y.jsx)(s.Badge.Ribbon,{style:{fontSize:"12px",display:n?"block":"none",zIndex:1e4},text:n?"\u53ef\u66ff":void 0,children:(0,y.jsxs)("div",{className:(0,l.W)(i,v&&u),ref:w,children:[B?.class&&B?.attribute?(0,y.jsxs)("div",{className:(0,l.W)(c,v&&d),children:[(0,y.jsx)("img",{className:h,alt:B.class,src:j.T2[B.class]}),(0,y.jsxs)("div",{className:m,children:[(0,y.jsx)("img",{className:x,alt:B.attribute,src:j.nP[B.attribute]}),B.secondary_attribute?(0,y.jsx)("img",{className:p,alt:B.secondary_attribute,src:j.nP[B.secondary_attribute]}):null]})]}):null,(0,y.jsxs)("div",{className:b,children:[(0,y.jsx)("div",{title:B?.aurorian_name,children:B?.aurorian_cn_name}),"number"==typeof r&&B?.rarity?(0,y.jsx)(s.ConfigProvider,{theme:{components:{Rate:{starBg:"white",starSize:8}}},children:(0,y.jsx)(s.Rate,{className:g,disabled:!0,value:r,count:j.gW[B.rarity]})}):null]})]})})}))},38706:(e,r,a)=>{a.d(r,{B:()=>i});var t=a(81821),n=(a(87363),a(10927));const o="AuroriansTeam-bW_gmF";var s=a(97458);const l=({aurorianSummaries:e})=>(0,s.jsx)("div",{className:o,children:e.map((({aurorian_name:e,breakthrough:r,is_replaceable:a})=>(0,s.jsx)(n.L,{name:e,breakthrough:r,isReplaceable:a},e)))}),i=[{title:"\u5149\u7075\u914d\u7f6e",dataIndex:"aurorian_summaries",hideInSearch:!0,render:(e,r)=>(0,s.jsx)(l,{aurorianSummaries:r.aurorian_summaries}),width:424},{title:"\u7ed3\u7b97\u5206\u6570",dataIndex:"score",valueType:"digit",hideInSearch:!0,width:130},{title:"\u4f5c\u8005",dataIndex:"author",valueType:"select",hideInSearch:!0,ellipsis:!0,width:160,renderText:(e,r)=>(0,s.jsxs)(s.Fragment,{children:[e,(0,s.jsx)(t.Tooltip,{title:r.description,children:r.description?"\u{1f5d2}":null})]})},{title:"\u6807\u9898",dataIndex:"title",ellipsis:!0,render:(e,r)=>(0,s.jsx)(t.Typography.Link,{href:`https://b23.tv/${r.bv}`,target:"_blank",title:r.title,children:r.title})},{title:"\u4e0a\u4f20\u65f6\u95f4",dataIndex:"upload_time",valueType:"dateTime",width:160,hideInSearch:!0}]},23243:(e,r,a)=>{a.d(r,{e:()=>u,l:()=>l});var t=a(87363),n=a(20383),o=a(38706),s=a(97458);function l(e){return e.bv}const i={pagination:{pageSize:5,size:"default",position:["bottomCenter"]},scroll:{x:"max-content",scrollToFirstRowOnChange:!0}},u=({dataSource:e,term:r})=>{const a=(0,t.useRef)(),u=(0,t.useMemo)((()=>({term:r,dataSource:e})),[r,e]),c=(0,t.useCallback)((async e=>({data:e.dataSource?.filter((r=>{let a=!0;return e.title&&(a=r.title.includes(e.title)),"number"==typeof e.score?.[0]&&(a=e.score[0]<=r.score),"number"==typeof e.score?.[1]&&(a=r.score<=e.score[1]),a}))??[],success:!0})),[]);return(0,s.jsx)(n.Z,{rowKey:l,actionRef:a,columns:o.B,params:u,request:c,...i})}},76473:(e,r,a)=>{a.d(r,{M:()=>i});var t=a(61093),n=a(81821),o=a(19279),s=a(3630),l=a(97458);const i=({pathFn:e})=>{const r=(0,o.UO)(),[a]=(0,t.tT)(s.d),i=(0,o.s0)();return(0,l.jsx)(n.Select,{value:r.term&&Number.parseInt(r.term,10),options:a.termsOptions,placeholder:"\u8352\u5178\u671f\u6570",onChange:r=>{i(e(r))}})}},64762:(e,r,a)=>{a.d(r,{n:()=>u});var t=a(61093),n=a(81821),o=a(98187),s=a(3630),l=a(29413),i=a(97458);const u=()=>{const[{firstTerm:e}]=(0,t.tT)(s.d);return(0,i.jsx)(n.Result,{status:"404",title:"\u8352\u5178\u4f5c\u4e1a\u4e0d\u89c1\u4e86",subTitle:"\u68c0\u67e5\u94fe\u63a5\u662f\u5426\u6b63\u786e\u6216\u8fd4\u56de\u6700\u8fd1\u8352\u5178\u4f5c\u4e1a",extra:e?(0,i.jsx)(o.rU,{to:l.h.Copilots(e.term),children:(0,i.jsx)(n.Button,{type:"primary",children:"\u8fd4\u56de\u6700\u8fd1\u4f5c\u4e1a"})}):(0,i.jsx)(o.rU,{to:l.h.Home,children:(0,i.jsx)(n.Button,{type:"primary",children:"\u8fd4\u56de\u9996\u9875"})})})}},23930:(e,r,a)=>{a.r(r),a.d(r,{default:()=>O});var t=a(19279),n=a(16799),o=a(87363),s=a(76470),l=a(64762),i=a(76473),u=a(32479),c=a(10389),d=a(48636),m=a(92921),h=a(81821),x=a(61093),p=a(55950),b=a.n(p),g=a(82547);function j(e,r,{disalbeAlternative:a}){return(0,g.Uy)(e,(e=>{for(const t of r.aurorian_summaries)!a&&t.is_replaceable||delete e[t.aurorian_name]}))}function f(e,r,{disalbeAlternative:a}){for(const t of r.aurorian_summaries){if(!a&&t.is_replaceable)continue;const r=e[t.aurorian_name];if(!r)return!1;if(r.breakthrough<t.breakthrough)return!1}return!0}function y(e,r=3,{disalbeAlternative:a}={}){const t={scenarios:[]},n=[{currentCopilotIndex:0,currentScenario:[],remainingBox:e.availableBox,count:r}];for(;n.length>0;){const{currentCopilotIndex:o,currentScenario:s,remainingBox:l,count:i}=n.pop();if(0===i||o===e.copilots.length)s.length>=r&&t.scenarios.push({copilots:[...s],totalScore:s.reduce(((e,r)=>e+BigInt(r.score)),BigInt(0))});else{const r=e.copilots[o];if(f(l,r,{disalbeAlternative:a})){const e=j(l,r,{disalbeAlternative:a});n.push({currentCopilotIndex:o+1,currentScenario:[...s,r],remainingBox:e,count:i-1})}n.push({currentCopilotIndex:o+1,currentScenario:s,remainingBox:l,count:i})}}return t.scenarios.sort(((e,r)=>Number(r.totalScore-e.totalScore))),t}var v=a(38259),S=a(20383),B=a(23243),w=a(38706),k=a(97458);const T=({solution:e,title:r})=>{const a=(0,o.useCallback)((async()=>({data:(0,g.Uy)(e.copilots,(e=>{e.sort(((e,r)=>Number(r.score-e.score)))})),success:!0})),[]),t=(0,o.useMemo)((()=>({title:r,settings:[]})),[r]),n=(0,o.useMemo)((()=>({x:"max-content"})),[]);return(0,k.jsx)(S.Z,{showHeader:!0,toolbar:t,rowKey:B.l,columns:w.B,request:a,search:!1,pagination:!1,scroll:n,ghost:!0})};var _=a(99624),C=a(46855),N=a(12781),I=a(67103),R=a(10927);const A=({name:e,...r})=>{const[{auroriansOptions:a,auroriansMap:t}]=(0,x.tT)(v.b);return(0,k.jsx)(_.u,{...r,creatorButtonProps:{creatorButtonText:"\u6dfb\u52a0\u6392\u9664\u7684\u5149\u7075"},name:e,alwaysShowItemLabel:!0,min:1,children:()=>(0,k.jsxs)(u.A.Group,{children:[(0,k.jsx)(C.Z,{label:"\u6392\u9664\u7684\u5149\u7075",name:"aurorianName",options:a,allowClear:!0,width:"sm",rules:[{required:!0}]}),(0,k.jsx)(m.Z,{name:["aurorianName"],children:({aurorianName:e})=>e?(0,k.jsx)(R.L,{sameSize:!0,name:e}):null},"excludeBreakthroughOnly"),(0,k.jsx)(m.Z,{name:["aurorianName"],children:({aurorianName:e})=>e?(0,k.jsx)(d.Z,{label:"\u4ec5\u6392\u9664\u7a81\u7834",name:"excludeBreakthroughOnly"}):null},"excludeBreakthroughOnly"),(0,k.jsx)(m.Z,{name:["aurorianName","excludeBreakthroughOnly"],children:({aurorianName:e,excludeBreakthroughOnly:r})=>{const a=t[e];return r&&a?(0,k.jsx)(N.Z,{name:"excludeBreakthrough",label:"\u6392\u9664\u7a81\u7834\u6570",fieldProps:{count:I.gW[a.rarity],allowHalf:!1},tooltip:"\u5927\u4e8e\u7b49\u4e8e\u6b64\u7a81\u7834\u6570\u7684\u5149\u7075\u4f1a\u88ab\u6392\u9664\uff0c\u4f46\u4e0d\u4f1a\u6392\u9664\u96f6\u7834\u7684\u6b64\u5149\u7075"}):null}},"excludeBreakthrough")]})})},M={k:3,box:"whole",exclude:[{}]},Z=({dataSource:e})=>{const[{WHOLE_BOX:r}]=(0,x.tT)(v.b),a=(0,o.useRef)(),[t,n]=(0,o.useState)(1),l=(0,o.useRef)(null),{data:i,loading:p,runAsync:j}=(0,s.Z)((async a=>{let t=r.aurorian_summaries;a.exclude&&(t=(0,g.Uy)(r.aurorian_summaries,(e=>{for(const r of a.exclude)r.excludeBreakthroughOnly?"number"==typeof r.excludeBreakthrough&&r.excludeBreakthrough>=1&&(e[r.aurorianName].breakthrough=r.excludeBreakthrough-1):delete e[r.aurorianName]})));const[n]=await Promise.all([Promise.resolve(y({copilots:e,availableBox:t},a.k,{disalbeAlternative:a.disalbeAlternative})),new Promise((e=>window.setTimeout(e,100)))]),o=new WeakMap;for(let e=0;e<n.scenarios.length;e++){const r=n.scenarios[e];o.set(r,e)}return{solutionResult:n,rankSet:o}}),{manual:!0,defaultParams:[M]});return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(h.Card,{style:{marginBottom:"1rem"},children:(0,k.jsx)(u.A,{formRef:a,onFinish:async e=>{await j(e),n(1)},initialValues:M,layout:"vertical",submitter:{searchConfig:{submitText:"\u5bfb\u627e\u5339\u914d\u65b9\u6848"},render:(e,r)=>(0,k.jsxs)(h.Space,{wrap:!0,children:[r,i?.solutionResult?(0,k.jsxs)(h.Typography.Text,{children:["\u5df2\u4e3a\u60a8\u627e\u5230"," ",(0,k.jsx)(h.Typography.Text,{strong:!0,children:i?.solutionResult.scenarios.length})," ","\u4e2a\u5339\u914d\u65b9\u6848"]}):null]})},loading:p,children:(0,k.jsxs)(u.A.Group,{children:[(0,k.jsx)(c.Z.Group,{name:"k",label:"\u961f\u4f0d\u6570\u91cf",rules:[{required:!0}],options:[{label:"\u4e24\u652f\u961f\u4f0d",value:2},{label:"\u4e09\u652f\u961f\u4f0d",value:3},{label:"\u56db\u652f\u961f\u4f0d",value:4}],allowClear:!1,radioType:"button"}),(0,k.jsx)(c.Z.Group,{name:"box",label:"Box \u5339\u914d",options:[{label:"\u5168\u56fe\u9274\u6ee1\u7a81\u7834 Box",value:"whole"},{label:"\u6211\u7684\u81ea\u5b9a\u4e49 Box",value:"my-box",disabled:!0}],allowClear:!1,radioType:"button",rules:[{required:!0}],extra:"\u81ea\u5b9a\u4e49 Box \u5339\u914d\u6682\u4e0d\u652f\u6301\uff0c\u65e0\u6cd5\u9009\u4e2d\uff0c\u656c\u8bf7\u671f\u5f85w"}),(0,k.jsx)(d.Z,{name:"disalbeAlternative",label:"\u4e0d\u8003\u8651\u53ef\u66ff\u81ea\u7531\u4f4d",tooltip:"\u5f00\u542f\u540e\uff0c\u8ba1\u7b97\u7684\u961f\u4f0d\u65b9\u6848\u4e2d\u7edd\u5bf9\u4e0d\u4f1a\u51fa\u73b0\u91cd\u590d\u5149\u7075\uff0c\u6ee1\u8db3\u56fe\u9274\u5927\u4f6c\u7684\u5f3a\u8feb\u75c7"}),(0,k.jsxs)(u.A.Group,{children:[(0,k.jsx)(d.Z,{name:"enableExclude",label:"\u989d\u5916\u6392\u9664\u5149\u7075",tooltip:"\u6392\u9664\u5149\u7075\u4f1a\u5ffd\u7565\u53ef\u66ff\u81ea\u7531\u4f4d"}),(0,k.jsx)(m.Z,{name:["enableExclude"],children:({enableExclude:e})=>e?(0,k.jsx)(A,{name:"exclude"}):null})]})]})})}),(0,k.jsx)("div",{ref:l}),(0,k.jsx)(h.List,{loading:p,dataSource:i?.solutionResult?.scenarios,pagination:{align:"center",defaultPageSize:5,current:t,onChange(e){n(e),window.scrollTo({top:l.current.offsetTop,behavior:"smooth"})},showSizeChanger:!1},rowKey:e=>e.copilots.map((e=>e.bv)).join(""),renderItem:e=>(0,k.jsx)(h.Card,{title:(0,k.jsxs)(k.Fragment,{children:[i?.rankSet?`#${(i.rankSet.get(e)??0)+1} \u5339\u914d\u65b9\u6848 `:null,b()(e.totalScore).format("0,0")]}),style:{marginBottom:"1rem"},children:(0,k.jsx)(T,{solution:e})},e.copilots.map((e=>e.bv)).join(""))})]})};var z=a(29413);const O=()=>{const e=(0,t.UO)(),{data:r,error:a,loading:u}=(0,s.Z)((()=>fetch(`/api/copilots/${e.term}.json`).then((e=>e.json()))),{refreshDeps:[e.term]}),c=(0,o.useMemo)((()=>Object.values(r??[])),[r]);return a?(0,k.jsx)(l.n,{}):(0,k.jsx)(n._z,{content:(0,k.jsx)(i.M,{pathFn:z.h.Solutions}),title:"\u4f5c\u4e1a\u5339\u914d",loading:u,children:(0,k.jsx)(Z,{dataSource:c})})}}}]);